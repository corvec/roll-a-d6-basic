{"version":3,"sources":["components/common/ButtonWithHelpText.js","components/hooks/useHoldOrClick.js","components/Calculator/CalculatorButton.js","components/common/ResultBuilder.js","components/Calculator/CalculatorDisplay.js","assets/D4.svg","assets/D6.svg","assets/D8.svg","assets/D10.svg","assets/D12.svg","assets/D20.svg","components/Calculator/Calculator.js","components/Calculator/index.js","components/History.js","components/common/ClickableValue.js","components/common/DragHandle.js","components/Collections/CollectionLink.js","components/Collections/FormulaEditor.js","components/Collections/CollectionChooserButton.js","lib/helpers.js","components/common/ConfirmationModal.js","components/Collections/RollButton.js","components/Collections/VariableEntry.js","components/Collections/SavedRoll.js","components/Collections/SavedValue.js","components/Collections/CollapsedSavedValue.js","components/common/TreeView.js","components/common/CollectionTreeViewSelector.js","components/common/ErrorAlert.js","components/common/SelectCollectionModal.js","components/Collections/Collections.js","components/Collections/index.js","state/AppState.js","state/CollectionsState/collectionsState.default.js","state/CollectionsState/helpers.js","state/CollectionsState/organization.js","state/CollectionsState/rolls.js","state/CollectionsState/index.js","state/CollectionsState/navigation.js","components/Changelog.js","components/Settings.js","App.js","serviceWorker.js","index.js"],"names":["ButtonWithHelpText","props","action","children","className","info","otherProps","actionWrapper","useState","show","setShow","longPress","holdAction","cancelHoldAction","clickAction","delay","holding","setHolding","doClickAction","useRef","holdTimer","useEffect","current","setTimeout","clearTimeout","start","useCallback","stop","startHolding","event","stopHolding","preventDefault","onMouseDown","onMouseUp","onMouseEnter","onMouseLeave","onTouchStart","onTouchEnd","useHoldOrClick","target","Button","ref","onBlur","Overlay","Tooltip","onClick","CalculatorButton","resultsType","PropTypes","arrayOf","oneOfType","bool","number","string","isRequired","ResultBuilder","objectOf","shape","minValue","maxValue","result","variable","Array","isArray","length","join","title","map","i","res","key","hasOwnProperty","Object","entries","value","results","CalculatorDisplay","formula","setFormula","rolls","formulaReadOnly","setFormulaReadOnly","Row","replace","Col","xs","values","flat","autoFocus","onChange","e","rows","Math","min","match","split","reduce","accum","line","floor","window","innerWidth","_extends","assign","arguments","source","prototype","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","createElement","id","opacity","fill","stroke","strokeWidth","strokeOpacity","strokeLinecap","strokeLinejoin","d","x","y","rotate","_ref","svgRef","width","height","viewBox","ForwardRef","forwardRef","transform","expansionInfo","operator","expansionOperator","Calculator","roll","saveRoll","CalcButton","character","val","DiceButton","sides","test","slice","variant","noGutters","sm","md","lg","Helper","name","Helpers","helpers","HistoryPane","scrollTo","setScrollTo","active","setActive","scrollIntoView","behavior","block","handleClick","contains","document","addEventListener","removeEventListener","getAllRolls","History","clearHistory","history","historyItem","ClickableValue","forceEditable","inputStyle","setEditing","spanStyle","updateOnBlur","setValue","isEditable","setEditableWrapped","setEditable","unsavedValue","setUnsavedValue","handleBlur","FormControl","onKeyPress","style","stopPropagation","icon","faEdit","size","DragHandle","sortableHandle","faEllipsisV","CollectionLink","collectionName","duplicate","move","navTo","rename","renaming","setRenaming","newName","ButtonGroup","FormulaEditor","controlled","editButton","readOnlyProp","setReadOnlyProp","readOnly","setReadOnly","editedFormulaValue","setEditedFormulaValue","type","CollectionChooserButton","collections","chosenCollection","setChosenCollection","DropdownButton","Dropdown","Item","collection","objectMakerReduceHelper","removeFromObject","otherEntities","renameObjectKeyPreserveOrder","oldKey","newKey","obj","getPropertyByPath","path","undefined","getUniqueName","container","getName","getNextName","ConfirmationModal","text","handleCancel","Modal","onHide","Header","closeButton","Title","Body","Footer","RollButton","hasMissingVariables","onlyUnknownVariable","suppliedValues","targetCollections","valuesFromTargetedCollections","disabled","faDice","VariableEntry","rollMetadata","setSuppliedValues","Form","Group","Label","column","unknownVariables","variableName","InputGroup","Prepend","Text","placeholder","noPromptVariables","includes","getTargetCollection","formulaTokenizer","stripPrefix","stripSuffix","SavedRoll","activateFormulaInCalculator","childCollections","clone","collapsed","convertPathStringToPathArray","getCollectionByPath","gotoResultInHistory","remove","setTargetCollections","modalProperties","setModalProperties","targetName","targetCollectionName","filter","some","hasVariables","targetedCollections","missingVariables","formulaValidator","validateClause","rollButtonProps","Card","Badge","as","faTrashAlt","targetCollection","valueName","alert","faEquals","faHistory","alt","faCalculator","faClone","SavedValue","editableFormula","setEditableFormula","hideValue","ro","CollapsedSavedValue","defaultContainer","TreeView","Container","data","node","CollectionNode","log","message","CollectionTreeViewSelector","pathToExclude","selectCollection","treeViewData","collectionPath","Root","collectionReduceHelper","ErrorMessage","errorMessage","setErrorMessage","Alert","dismissible","onClose","SelectCollectionModal","ErrorAlert","err","handleOK","SortableRow","sortableContainer","SortableDivContainer","SortableCollectionLink","sortableElement","SortableSavedValue","SortableSavedRoll","SortableCollapsedValue","Collections","collectionState","selectCalculator","selectHistory","newCollectionName","setNewCollectionName","newRollName","setNewRollName","setCollapsed","selectCollectionProperties","setSelectCollectionProperties","activate","removeRoll","rollHandler","suppliedString","sentFormula","sideEffects","setLastRoll","historyIndex","CollapseButton","faCompressArrowsAlt","ExpandButton","faExpandArrowsAlt","activeCollection","currentCollection","getRollsWithDetails","removeCurrentCollection","renameCurrentCollection","rollsAndValues","handleMoveSavedItem","collectionType","oldIndex","newIndex","itemName","destName","newIndexInFullList","findIndex","moveRoll","Breadcrumb","href","navigateToParent","createCollection","onSortEnd","moveChildCollection","useDragHandle","index","collectionToMove","destination","navigateTo","renameChildCollection","createRoll","axis","valueIndex","renameRoll","rollIndex","getRollInfo","cloneRoll","fetchFromLocalStorage","defaultValue","localStorage","getItem","JSON","parse","setWrapper","setter","setItem","stringify","historyHelpers","historyValue","historySetter","futureValue","futureSetter","timeTraveler","moveBack","moveForward","viewTimeline","past","present","future","traveler","newValue","useStateWrapper","enableHistory","transformStartingValue","startingValue","startingHistoryValue","startingFutureValue","AppState","activeTab","setActiveTab","setHistory","setResult","setRolls","scrollToItem","setScrollToItem","pushHistoryItem","defaultCollectionsState","Shared","atk","bonus","armor","shield","leatherArmor","paddedArmor","studdedLeatherArmor","hideArmor","chainShirt","scaleMail","breastPlate","halfPlate","ringMail","chainMail","splintArmor","plateArmor","weapons","club","dagger","greatClub","handAxe","javelin","lightHammer","mace","quarterstaff","sickle","spear","unarmedStrike","lightCrossbow","dart","shortbow","sling","battleaxe","flail","glaive","greataxe","greatsword","halberd","lance","longSword","maul","morningstar","pike","rapier","scimitar","shortSword","trident","warPick","warhammer","whip","blowgun","handCrossbow","heavyCrossbow","longbow","net","Default","initiative","duelingStyle","secondWind","maneuverSaveDC","superiorityDie","Str","Dex","Con","Int","Wis","Cha","prof","AC","saves","strSave","dexSave","conSave","intSave","wisSave","chaSave","skills","Athletics","Acrobatics","Stealth","Arcana","Investigation","Nature","Religion","Insight","Medicine","Perception","Survival","Deception","Intimidation","Performance","Persuasion","sneakAttackIfPossible","sneakAttack","getPathString","organization","setActiveCollection","setCollections","parentCollection","pathToParent","immutably","set","createCollectionInCurrentCollection","currentCollectionName","updatedCollections","newCollection","destinationPath","currentPath","newPath","Error","updateStage1","updatedCurrentCollection","updateStage2","collArray","newCollections","oldName","handleConflict","prompt","updatedParentCollection","renameObjectKey","variableTargetsCollection","getMacrosFromCollection","formulaParser","getRollMetadata","addRollToCurrentCollection","getCurrentPath","applySideEffects","currentCollections","collectionsAccum","sideEffectName","getCollectionPathForSideEffect","sideEffectBaseName","clearHistoryReferenceFromRoll","clearCollectionHistoryReduceHelper","rollName","getRollFormula","getRolls","parentRolls","_","sharedRolls","getChildRolls","child","childRolls","getRollDetails","macrosFromCollection","rollDetails","newRolls","moveToEnd","rollsArray","confirm","rollObj","newRollObj","CollectionsState","stateHooks","navigation","getCollectionByPathReduceHelper","pathSegment","collectionsToSearch","substring","navigateToRoot","parentNumber","Navigation","Rolls","Organization","changes","version","date","features","Changelog","changelogVisible","setChangelogVisible","animateOnMount","animationIn","animationOut","animationDuration","isVisible","reverse","feature","styles","bold","fontWeight","handleFile","file","a","console","location","reload","Settings","File","saveAs","accept","currentTarget","files","clear","App","defaultRollSuccessCallback","resultRange","expression","successCallback","helpersMap","rollResult","rollFormula","helper","ary","allMacros","macros","error","calculatorMacros","display","item","Boolean","hostname","ReactDOM","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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O,aACLrO,mBACA1J,eACG+X,EAHL,GAIKhhB,EAJL,GAKKqd,I,sDEtCDqE,I,OAAU,CACd,CACEC,QAAS,MACTC,KAAM,aACNC,SAAU,CACR,kBACA,oCAGJ,CACEF,QAAS,MACTC,KAAM,aACNC,SAAU,CACR,iCACA,gBACA,wEAGJ,CACEF,QAAS,MACTC,KAAM,aACNC,SAAU,CACR,0CACA,gBACA,+DACA,yCACA,kCAGJ,CACEF,QAAS,MACTC,KAAM,aACNC,SAAU,CACR,+CACA,2DACA,wCAGJ,CACEF,QAAS,MACTC,KAAM,aACNC,SAAU,CACR,+CACA,2DACA,wCAGJ,CACEF,QAAS,QACTC,KAAM,aACNC,SAAU,CACR,kBAGJ,CACEF,QAAS,MACTC,KAAM,cACNC,SAAU,CACR,iCACA,qBACA,4GACA,oCACA,gDACA,oFACA,kCACA,wEAGJ,CACEF,QAAS,MACTC,KAAM,cACNC,SAAU,CACR,oHACA,gEACA,oBAGJ,CACEF,QAAS,MACTC,KAAM,cACNC,SAAU,CACR,wBACA,gCACA,uBAGJ,CACEF,QAAS,MACTC,KAAM,cACNC,SAAU,CACR,sCACA,+DACA,+CAGJ,CACEF,QAAS,OACTC,KAAM,cACNC,SAAU,CACR,qBACA,iCACA,iEACA,oGAGJ,CACEF,QAAS,OACTC,KAAM,cACNC,SAAU,CACR,uBACA,cACA,yGAGJ,CACEF,QAAS,SACTC,KAAM,cACNC,SAAU,CACR,gCACA,uGAGJ,CACEF,QAAS,OACTC,KAAM,cACNC,SAAU,CACR,4BACA,mEAGJ,CACEF,QAAS,OACTC,KAAM,aACNC,SAAU,CACR,uBACA,wEACA,uCACA,6DACA,+EACA,uEAGJ,CACEF,QAAS,OACTC,KAAM,aACNC,SAAU,CACR,iCACA,0BACA,gCACA,wBAGJ,CACEF,QAAS,OACTC,KAAM,cACNC,SAAU,CACR,oCACA,mFACA,yCACA,qFACA,sDACA,oDACA,wDACA,8BACA,gEACA,mEAGJ,CACEF,QAAS,OACTC,KAAM,cACNC,SAAU,CACR,oDACA,8EAGJ,CACEF,QAAS,OACTC,KAAM,aACNC,SAAU,CACR,gCACA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","file":"static/js/main.81617124.chunk.js","sourcesContent":["import React, { useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport Button from 'react-bootstrap/Button';\nimport Tooltip from 'react-bootstrap/Tooltip';\nimport Overlay from 'react-bootstrap/Overlay';\nimport useHoldOrClick from '../hooks/useHoldOrClick';\n\nconst ButtonWithHelpText = (props) => {\n  const {\n    action,\n    children,\n    className,\n    info,\n    ...otherProps\n  } = props;\n\n  const actionWrapper = () => {\n    action();\n  };\n\n  const [show, setShow] = useState(false);\n  const longPress = useHoldOrClick({\n    holdAction: () => setShow(true),\n    cancelHoldAction: () => setShow(false),\n    clickAction: actionWrapper,\n    delay: 500,\n  });\n  const target = useRef(null);\n\n  if (info) {\n    return (\n      <>\n        <Button\n          ref={target}\n          className={className}\n          {...longPress}\n          {...otherProps}\n          onBlur={() => setShow(false)}\n        >\n          {children}\n        </Button>\n        <Overlay\n          show={show}\n          target={target.current}\n        >\n          <Tooltip>{info}</Tooltip>\n        </Overlay>\n      </>);\n  } else {\n    return (\n      <Button\n        className={className}\n        onClick={actionWrapper}\n        {...otherProps}>\n        {children}\n      </Button>\n    );\n  }\n};\n\nButtonWithHelpText.propTypes = {\n  action: PropTypes.func.isRequired,\n  children: PropTypes.node.isRequired,\n};\n\nexport default ButtonWithHelpText;\n","import { useState, useEffect, useCallback, useRef } from 'react';\n/* eslint fp/no-mutation: ['error', {exceptions: [{property:'current'}]}] */\n\n/**\n * A custom React Hook that supports a hover / long press action (for mobile) and onClick action.\n * It ensures that if the long press action is called, the onClick action will not be called (unless\n * the user clicks again).\n *\n * @param {Function} holdAction Call this when the long press is triggered\n * @param {Function} cancelHoldAction After longPressAction has been called, if the triggering event ends, call this.\n * @param {Function} clickAction Action to take on click\n * @param {number} delay Time to wait from mouse down to executing the longPressAction, in milliseconds\n * @returns {object.<string, Function>} Action handler props for the target component\n */\n\nexport default function useHoldOrClick({\n  holdAction = () => {},\n  cancelHoldAction = () => {},\n  clickAction = () => {},\n  delay = 1000,\n}) {\n  const [holding, setHolding] = useState(false);\n  const doClickAction = useRef(false);\n  const holdTimer = useRef(0);\n\n  useEffect(() => {\n    if (holding) {\n      holdTimer.current = setTimeout(() => {\n        doClickAction.current = false;\n        holdAction();\n      }, delay);\n    } else {\n      clearTimeout(holdTimer.current);\n      holdTimer.current = 0;\n    }\n\n    return () => {\n      clearTimeout(holdTimer.current);\n      holdTimer.current = 0;\n    };\n  }, [holdAction, delay, holding]);\n\n  const start = useCallback(() => {\n    setHolding(true);\n  }, []);\n\n  const stop = useCallback(() => {\n    setHolding(false);\n    cancelHoldAction();\n  }, [cancelHoldAction]);\n\n  const startHolding = useCallback(event => {\n    if (holdTimer.current) {\n      clearTimeout(holdTimer.current);\n    }\n    doClickAction.current = true;\n    start();\n  }, [start]);\n\n  const stopHolding = useCallback(event => {\n    if (doClickAction.current) {\n      doClickAction.current = false;\n      clickAction();\n    }\n    stop();\n    event.preventDefault();\n  }, [clickAction, stop]);\n\n  return {\n    onMouseDown: startHolding,\n    onMouseUp: stopHolding,\n    onMouseEnter: start,\n    onMouseLeave: () => {\n      doClickAction.current = false;\n      stop();\n    },\n    onTouchStart: startHolding,\n    onTouchEnd: stopHolding,\n  };\n}\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport ButtonWithHelpText from '../common/ButtonWithHelpText';\n\nconst CalculatorButton = ({ className, children, ...otherProps }) => (\n  <ButtonWithHelpText\n    className={`calculator-button ${className ? className : ''}`}\n    {...otherProps}\n  >{children}</ButtonWithHelpText>\n);\n\nCalculatorButton.propTypes = {\n  action: PropTypes.func.isRequired,\n  children: PropTypes.node.isRequired,\n};\n\nexport default CalculatorButton;\n","import React from 'react';\nimport PropTypes from 'prop-types';\n\nconst ResultBuilder = ({ className, result }) => {\n  if (typeof result === 'string') {\n    return <span className={className}>result</span>;\n  }\n  if (Array.isArray(result) && result.length > 0) {\n    if (typeof result[0] !== 'object') {\n      return <span>{result.join(', ')}</span>;\n    } else if (typeof result[0] === 'object') {\n      if (result.length === 1) {\n        return <span title={`value of ${result[0].variable || 'variable'} had no impact`}>\n          <strong>{result[0].result.join(', ')}</strong>\n        </span>;\n      }\n      return (<ul className=\"results-set\">{\n        result.map(\n          ({ minValue, maxValue, result: res, variable }, i) => {\n            return (<li key={i}>\n              {typeof variable === 'string' ? variable : ''} {\n              minValue > 0 ? `${minValue}` : ''}\n              {\n                minValue === 0\n                  ? `${maxValue} or below`\n                  : typeof maxValue === 'number'\n                  ? `-${maxValue}` : ' or above'\n              }: {res.join(', ')}\n            </li>);\n          })\n      }</ul>);\n    }\n  }\n  if (typeof result === 'object' && result.hasOwnProperty(0)) {\n    return (\n      <ul className=\"results-set\">\n        {\n          Object.entries(result)\n            .map(([ value, results ], i) =>\n              <li key={i}>\n                >= {value}: {results.join(', ')}\n              </li>\n            )\n\n        }\n      </ul>);\n  }\n\n  return <span>Cannot parse result</span>;\n};\n\nconst resultsType = PropTypes.arrayOf(\n  PropTypes.oneOfType([PropTypes.bool, PropTypes.number, PropTypes.string]).isRequired\n).isRequired;\n\nexport const resultPropType = PropTypes.oneOfType([\n  resultsType,\n  PropTypes.objectOf(resultsType).isRequired,\n  PropTypes.arrayOf(PropTypes.shape({\n    minValue: PropTypes.oneOfType([PropTypes.number, PropTypes.string]).isRequired,\n    maxValue: PropTypes.oneOfType([PropTypes.number, PropTypes.string]),\n    result: resultsType,\n    variable: PropTypes.string,\n  }).isRequired).isRequired\n]);\n\nResultBuilder.propTypes = {\n  className: PropTypes.string,\n  result: resultPropType.isRequired,\n};\n\nexport default ResultBuilder;\n","import React, { useState } from 'react';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport ResultBuilder from '../common/ResultBuilder';\nimport './calculator-display.css';\n\nconst CalculatorDisplay = ({ formula, setFormula, result, rolls }) => {\n  const [formulaReadOnly, setFormulaReadOnly] = useState(true);\n\n  const blurFormulaEditor = () => {\n    setFormulaReadOnly(true);\n    setFormula(formula.replace(/\\s+/g, ','));\n  };\n  const enableFormulaEditor = () => {\n    setFormulaReadOnly(false);\n    setFormula(formula.replace(/,/g, '\\n'));\n  };\n  const softBreaks = () => formula.split('\\n').reduce((accum, line) => accum + Math.floor(10 * line.length / window.innerWidth), 0);\n  const formulaLineCount = () => (formula.match(/\\n/g) || []).length + softBreaks() + 1;\n\n\n  return (<div className=\"calculator-display\">\n      {\n        formulaReadOnly\n          ? (<>\n            <Row className=\"formula\" onClick={enableFormulaEditor}>\n              <Col xs={12}>\n                <strong>Enter Formula:</strong> {formula}\n              </Col>\n            </Row>\n            <Row className=\"result\">\n              <Col xs={12} className=\"text-right\">\n                <ResultBuilder result={result} />\n              </Col>\n            </Row>\n            <Row className=\"rolls\">\n              <Col xs={12} className=\"text-right\">\n                Roll Detail: {(Array.isArray(rolls) ? rolls : Object.values(rolls).flat()).join(', ')}\n              </Col>\n            </Row>\n          </>)\n          : (<Row>\n              <textarea\n                autoFocus\n                className=\"formula-editor\"\n                onBlur={blurFormulaEditor}\n                onChange={e => setFormula(e.target.value)}\n                rows={Math.min(3, formulaLineCount())}\n                value={formula}\n              />\n          </Row>)\n      }\n    </div>);\n}\n\nexport default CalculatorDisplay;\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Pen\",\n  opacity: 1\n}, React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"currentColor\",\n  strokeWidth: 4.816,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 316.139 427.492 L 624.816 152.906 L 606.393 587.538 L 314.646 426.531 Z\"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"currentColor\",\n  stroke: \"currentColor\",\n  strokeWidth: 4.816,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 316.139 427.492 L 624.816 152.906 L 284.378 322.523 L 315.181 427.196 Z\"\n}));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"style\", null, \"\\n    .face { font: bold 100px sans-serif; color: #000; }\\n  \");\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"text\", {\n  x: 480,\n  y: 380,\n  className: \"face\",\n  rotate: 30\n}, \"4\");\n\nvar SvgD4 = function SvgD4(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: \"3in\",\n    height: \"3in\",\n    viewBox: \"273.622864 143.397644 360.203491 453.166077\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, _ref2, _ref3, _ref4);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgD4, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/D4.9ce47f68.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  fill: \"none\",\n  stroke: \"#000\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  strokeWidth: 2\n}, React.createElement(\"path\", {\n  d: \"M322.742 216.096l281.993 10.56M604.735 226.656l84.747-50.987M428.142 172.329l261.34 3.34M322.742 216.096l105.4-43.767M613.47 557.568l-8.735-330.912M330.084 540.076l283.386 17.492M322.742 216.096l7.342 323.98M613.47 557.568l87.313-78.089M689.482 175.669l11.301 303.81\"\n}));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"style\", null, \"\\n        .face { font: bold 120px sans-serif; }\\n    \");\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"text\", {\n  x: 445,\n  y: 420,\n  className: \"face\"\n}, \"6\");\n\nvar SvgD6 = function SvgD6(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    viewBox: \"314.905914 164.895447 393.147491 400.311523\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, _ref2, _ref3, _ref4);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgD6, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/D6.ec22ebaa.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Pen\",\n  opacity: 1\n}, React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 4,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 303.547 370.559 L 558.797 249.609 \"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 4,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 532.797 577.641 L 304.484 371.496 \"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 4,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 527.688 213.246 L 304.938 369.164 \"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 4,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 559.062 250.207 L 529.734 212.578 \"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 4,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 558.141 250.336 L 744.719 387.281 \"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 4,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 533.516 577.781 L 743.328 388.547 \"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 4,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 534.453 577.512 L 559.656 253.922 \"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 4,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 529.078 212.180 L 743.719 384.434 \"\n}));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"style\", null, \"\\n    .face { font: bold 120px sans-serif; }\\n  \");\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"text\", {\n  x: 420,\n  y: 380,\n  className: \"face\",\n  rotate: 40\n}, \"8\");\n\nvar SvgD8 = function SvgD8(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: \"3.482329in\",\n    height: \"2.900105in\",\n    viewBox: \"295.238251 203.716797 459.667450 382.813843\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, _ref2, _ref3, _ref4);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgD8, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/D8.a62fed08.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  fill: \"none\",\n  stroke: \"#000\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  strokeWidth: 2.75\n}, React.createElement(\"path\", {\n  d: \"M634.359 485.582c-58.104-22.47267-116.208-44.94533-174.312-67.418M460.047 418.164c52.24467-31.27333 104.48933-62.54667 156.734-93.82M664.547 401.84l-47.766-77.496M634.359 485.582c10.06267-27.914 20.12533-55.828 30.188-83.742M634.359 485.582c-11.01567 16.63267-22.03133 33.26533-33.047 49.898M601.312 535.48c-23.42167-.0467-46.84333-.0933-70.265-.14M531.047 535.34c-23.66667-39.05867-47.33333-78.11733-71-117.176M460.047 418.164l48.969-109.746M509.016 308.418c24.39567-5.55067 48.79133-11.10133 73.187-16.652M616.781 324.344c-11.526-10.85933-23.052-21.71867-34.578-32.578\"\n}));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"style\", null, \"\\n        .face { font: bold 100px sans-serif; }\\n    \");\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"text\", {\n  x: 550,\n  y: 380,\n  className: \"face\",\n  transform: \"rotate(-90 620 370)\"\n}, \"0\");\n\nvar SvgD10 = function SvgD10(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    viewBox: \"453.655792 286.173126 217.537933 255.637604\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, _ref2, _ref3, _ref4);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgD10, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/D10.d1114b59.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  fill: \"none\",\n  stroke: \"#000\",\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  strokeWidth: 2.75\n}, React.createElement(\"path\", {\n  d: \"M341.141 1329.531l-119.643-149.928M221.498 1179.603c26.23501-50.0123 53.42199-100.6597 79.657-150.672M301.155 1028.931c59.53666 18.3167 120.44934 35.9323 179.986 54.249M503.047 1268.629c-7.302-61.8163-14.604-123.6327-21.906-185.449M341.141 1329.531c53.96866-20.3007 107.93734-40.6013 161.906-60.902M503.047 1268.629l124.341 4.137M383.545 1355.043c-14.13467-8.504-28.26933-17.008-42.404-25.512M383.545 1355.043c43.54666-8.7577 87.09334-17.5153 130.64-26.273M627.388 1272.766c-37.73433 18.668-75.46867 37.336-113.203 56.004M481.141 1083.18c39.45333-33.497 78.90667-66.994 118.36-100.491M679.605 1095.529c-26.70135-37.6133-53.40265-75.2267-80.104-112.84M627.388 1272.766c17.25366-58.3407 34.96334-118.8963 52.217-177.237M221.498 1179.603c-4.93667-12.298-9.87333-24.596-14.81-36.894M206.688 1142.709c21.61266-49.6567 43.22534-99.3133 64.838-148.97M271.526 993.739c19.78633-25.702 39.57267-51.404 59.359-77.106M331.169 916.767c-10.00467 37.388-20.00933 74.776-30.014 112.164M330.885 916.633c54.564-9.11367 109.128-18.22733 163.692-27.341M599.501 982.689c-34.97467-31.13233-69.94933-62.26467-104.924-93.397\"\n}));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"style\", null, \"\\n        .face { font: bold 120px sans-serif; }\\n    \");\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"text\", {\n  x: 320,\n  y: 1220,\n  className: \"face\",\n  transform: \"rotate(-20 360 1270)\"\n}, \"12\");\n\nvar SvgD12 = function SvgD12(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    viewBox: \"198.249146 880.02063 489.612305 484.870728\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, _ref2, _ref3, _ref4);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgD12, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/D12.95e846da.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"g\", {\n  id: \"Pen\",\n  opacity: 1\n}, React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 1.2,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 526.013 513.496 L 446.328 451.560 L 412.859 375.647 L 430.503 271.071 L 499.972 224.218 L 594.028 201.348 L 673.656 267.651 L 710.747 343.856 L 685.719 449.512 L 620.867 494.260 Z\"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 1.2,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 526.013 513.496 L 541.541 480.143 L 641.036 438.115 L 628.825 324.868 L 524.403 298.310 L 471.372 392.166 L 541.541 480.143 \"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 1.2,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 412.859 375.647 L 471.486 392.685 \"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 1.2,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 524.403 298.310 L 499.373 223.806 \"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 1.2,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 628.825 324.868 L 673.770 268.170 \"\n}), React.createElement(\"path\", {\n  opacity: 1,\n  fill: \"none\",\n  stroke: \"#000000\",\n  strokeWidth: 1.2,\n  strokeOpacity: 1,\n  strokeLinecap: \"round\",\n  strokeLinejoin: \"round\",\n  d: \"M 685.719 449.512 L 639.952 437.809 \"\n}));\n\nvar _ref3 = /*#__PURE__*/React.createElement(\"style\", null, \"\\n    .face { font: bold 90px sans-serif; }\\n  \");\n\nvar _ref4 = /*#__PURE__*/React.createElement(\"text\", {\n  x: 530,\n  y: 420,\n  className: \"face\",\n  transform: \"rotate(-20 575 465)\"\n}, \"20\");\n\nvar SvgD20 = function SvgD20(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: \"2.331688in\",\n    height: \"2.440335in\",\n    viewBox: \"407.917816 196.371399 307.782867 322.124268\",\n    ref: svgRef\n  }, props), title ? React.createElement(\"title\", null, title) : null, _ref2, _ref3, _ref4);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgD20, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/D20.fcc58258.svg\";\nexport { ForwardRef as ReactComponent };","import React from 'react';\nimport PropTypes from 'prop-types';\nimport './calculator-buttons.css';\nimport CalculatorButton from './CalculatorButton';\nimport CalculatorDisplay from './CalculatorDisplay';\nimport { ReactComponent as D4 } from '../../assets/D4.svg';\nimport { ReactComponent as D6 } from '../../assets/D6.svg';\nimport { ReactComponent as D8 } from '../../assets/D8.svg';\nimport { ReactComponent as D10 } from '../../assets/D10.svg';\nimport { ReactComponent as D12 } from '../../assets/D12.svg';\nimport { ReactComponent as D20 } from '../../assets/D20.svg';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\n\nconst expansionInfo = (operator, expansionOperator) => `a #${expansionOperator || `${operator}`} b - Expand into b ${operator} b ${operator} b... where b is repeated a times. NOTE: b may only be a single roll, value, or variable - it cannot be enclosed in parentheses.`;\n\nconst Calculator = ({\n  formula, result, rolls, roll, saveRoll, setFormula,\n}) => {\n  const add = character => () => setFormula(`${formula}${character}`);\n  const backspace = () => setFormula(formula.slice(0,-1));\n  const clear = () => setFormula('');\n\n  const CalcButton = ({ children, ...props }) => (\n    <CalculatorButton action={add(props.val || children)} {...props}>{children}</CalculatorButton>\n  );\n  const DiceButton = ({ children, sides, ...otherProps }) => (\n    <CalcButton\n      className=\"dice\"\n      info={`A ${sides || '??'} sided die.${sides ? '' : ' You need to enter the number of sides yourself.'}`}\n      val={`${/\\d/.test(formula.slice(-1)) ? '' : '1'}d${sides || ''}`}\n      variant=\"outline-success\"\n      {...otherProps}\n    >\n      {children}\n    </CalcButton>\n  );\n  return (<Container className=\"calculator\">\n    <h1>Calculator</h1>\n    <CalculatorDisplay\n      formula={formula}\n      setFormula={setFormula}\n      result={result}\n      rolls={rolls}\n    />\n    <Row className=\"buttons\" noGutters>\n      <Col xs={9}>\n        <Row noGutters>\n          <Col className=\"mb-1\" sm={10} md={6} lg={4}>\n            <CalcButton className=\"number\">7</CalcButton>\n            <CalcButton className=\"number\">8</CalcButton>\n            <CalcButton className=\"number\">9</CalcButton>\n            <CalcButton className=\"arithmetic\">+</CalcButton>\n            <CalcButton className=\"number\">4</CalcButton>\n            <CalcButton className=\"number\">5</CalcButton>\n            <CalcButton className=\"number\">6</CalcButton>\n            <CalcButton className=\"arithmetic\">-</CalcButton>\n            <CalcButton className=\"number\">1</CalcButton>\n            <CalcButton className=\"number\">2</CalcButton>\n            <CalcButton className=\"number\">3</CalcButton>\n            <CalcButton className=\"arithmetic\">*</CalcButton>\n            <CalcButton className=\"number\">0</CalcButton>\n            <CalcButton className=\"arithmetic\" info=\"A grouping operator\">(</CalcButton>\n            <CalcButton className=\"arithmetic\" info=\"A grouping operator\">)</CalcButton>\n            <CalcButton className=\"arithmetic\" info=\"Integer division\">/</CalcButton>\n          </Col>\n          <Col className=\"mb-1\" sm={10} md={6} lg={4}>\n            <DiceButton sides={20}><D20 className=\"success\" height=\"45px\" width=\"45px\" /></DiceButton>\n            <DiceButton sides={12}><D12 className=\"success\" height=\"45px\" width=\"45px\" /></DiceButton>\n            <DiceButton sides={10}><D10 className=\"success\" height=\"45px\" width=\"45px\" /></DiceButton>\n            <DiceButton sides={8}><D8 className=\"success\" height=\"45px\" width=\"45px\" /></DiceButton>\n            <DiceButton sides={6}><D6 className=\"success\" height=\"45px\" width=\"45px\" /></DiceButton>\n            <DiceButton sides={4}><D4 className=\"success\" height=\"45px\" width=\"45px\" /></DiceButton>\n            <DiceButton sides={100}>d100</DiceButton>\n            <DiceButton sides={null}>d?</DiceButton>\n          </Col>\n          <Col sm={10} md={6} lg={4}>\n            <CalcButton className=\"compare\" info=\"a<b - is a less than b?\">{'<'}</CalcButton>\n            <CalcButton className=\"compare\" info=\"a<=b - is a less than or equal to b?\">{'<='}</CalcButton>\n            <CalcButton className=\"compare\" info=\"a>b - is a greater than b?\">{'>'}</CalcButton>\n            <CalcButton className=\"compare\" info=\"a>=b - is a greater than or equal to b?\">{'>='}</CalcButton>\n            <CalcButton className=\"compare\" info=\"a==b - is a equal to b?\">{'=='}</CalcButton>\n            <CalcButton className=\"compare\" info=\"a<>b - is a not equal to b?\">{'<>'}</CalcButton>\n            <CalcButton className=\"compare\" info=\"a>>b - returns the greater of a and b. NOTE: can be chained (4>>5>>6>>3 returns 6)\">Max</CalcButton>\n            <CalcButton className=\"compare\" info=\"a<<b - returns the lesser of a and b. NOTE: can be chained (4<<5<<3<<6 returns 3)\">Min</CalcButton>\n            <CalcButton\n              info=\"Assign to a single variable in your formula to see multiple results for different values of the variable\"\n              variant=\"outline-secondary\"\n            >?</CalcButton>\n            <CalcButton info=\"a||b - a OR b - if a is true or non-zero, then a, otherwise b\" variant=\"outline-secondary\">||</CalcButton>\n            <CalcButton info=\"a&&b - a AND b - if a is true or non-zero, then b, otherwise a\" variant=\"outline-secondary\">&&</CalcButton>\n            <CalcButton\n              info=\"After a conditional, use this to set your result to the next expression if the conditional is true, or keep the expression's value otherwise, e.g., 1d6==6->10 (returns either false or 10)\"\n              val='->'\n              variant=\"outline-secondary\"\n            >Then</CalcButton>\n            <CalcButton\n              info=\"Else - Use when you want a value other than false if your conditional fails, e.g., 1d6>5;55 (returns true on a 6 and 55 otherwise). Use in conjunction for maximum power: 1d20>10->1d8+5;0\"\n              val=\";\"\n              variant=\"outline-secondary\"\n            >Else</CalcButton>\n          </Col>\n          <Col sm={10} md={6} lg={4}>\n            <CalcButton className=\"expansion\" info={expansionInfo('+')}>#+</CalcButton>\n            <CalcButton className=\"expansion\" info={expansionInfo('*')}>#*</CalcButton>\n            <CalcButton className=\"expansion\" info={expansionInfo('||', '|')}>#|</CalcButton>\n            <CalcButton className=\"expansion\" info={expansionInfo('&&', '&')}>#&</CalcButton>\n            <CalcButton className=\"macro\" info=\"a[0] - Local instance variable. Use this to refer to the same macro evaluation in case you need to check a value twice.\">[</CalcButton>\n            <CalcButton className=\"macro\" info=\"a[0] - Local instance variable. Use this to refer to the same macro evaluation in case you need to check a value twice.\">]</CalcButton>\n            <CalcButton className=\"macro\" info=\"a{0} - Use to refer to an instance variable that is preserved across the entire roll\">{'{'}</CalcButton>\n            <CalcButton className=\"macro\" info=\"a{0} - Use to refer to an instance variable that is preserved across the entire roll\">{'}'}</CalcButton>\n            <CalcButton className=\"macro\" info=\"Assign a value or macro to a variable, e.g., modifier=5,1d6+modifier\">=</CalcButton>\n            <CalcButton className=\"macro\" info=\"Indicates a variable should be 0 if not provided, e.g., ^adv\">^</CalcButton>\n            <CalcButton className=\"macro\" info=\"Designates variables that should come from a collection, e.g., ac@Defender\">@</CalcButton>\n            <CalcButton className=\"macro\" info=\"Separates clauses - either assignments or distinct results.\">,</CalcButton>\n          </Col>\n        </Row>\n      </Col>\n      <Col xs={3}>\n        <CalculatorButton action={backspace} className=\"func\"></CalculatorButton>\n        <CalculatorButton action={clear} className=\"func\" info=\"Clear the formula entered into the calculator\">Clear</CalculatorButton>\n        <CalculatorButton action={saveRoll} className=\"save func\" info=\"Save this roll into the current collection\">Save Roll</CalculatorButton>\n        <CalculatorButton action={roll} className=\"roll func\">Roll!</CalculatorButton>\n      </Col>\n    </Row>\n  </Container>);\n};\n\nCalculator.propTypes = {\n  formula: PropTypes.string.isRequired,\n  result: PropTypes.arrayOf(PropTypes.oneOfType([\n    PropTypes.bool,\n    PropTypes.number,\n    PropTypes.string,\n  ]).isRequired).isRequired,\n  rolls: PropTypes.arrayOf(PropTypes.string.isRequired).isRequired,\n  roll: PropTypes.func.isRequired,\n  saveRoll: PropTypes.func.isRequired,\n  setFormula: PropTypes.func.isRequired,\n};\n\nexport default Calculator;\n","import Calculator from './Calculator';\n\nexport default Calculator;\n","import React, { useRef, useEffect, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport './history.css';\nimport ResultBuilder from './common/ResultBuilder';\nimport {getAllRolls} from \"roll-a-d6/lib/helpers\";\n\nconst Helper = ({ name, value, source }) => (\n  <li>\n    <strong>{name}</strong> (from {source}): {value}\n  </li>\n);\nconst Helpers = ({ helpers }) => {\n  return <ul className=\"helpers-details\">\n    {\n      helpers.map((props, i) => <Helper key={i} {...props} />)\n    }\n  </ul>;\n};\n\nconst HistoryPane = ({ formula, helpers, result, rolls, scrollTo, setScrollTo }) => {\n  const [active, setActive] = useState(false);\n  const ref = useRef();\n  useEffect(() => {\n    if (scrollTo) {\n      setActive(true);\n      ref.current.scrollIntoView({\n        behavior: 'smooth',\n        block: 'start',\n      });\n      return () => {\n        setScrollTo(null);\n      }\n    }\n  }, [ref, scrollTo, setScrollTo]);\n  const handleClick = event => {\n    if (ref.current.contains(event.target)) {\n      event.preventDefault();\n      setActive(true);\n    } else {\n      setActive(false);\n    }\n  };\n  useEffect(() => {\n    document.addEventListener(\"click\", handleClick);\n    return () => {\n      document.removeEventListener(\"click\", handleClick);\n    };\n  }, []);\n  return (\n    <li ref={ref} className={`history-item ${active ? 'active' : ''}`}>\n      <div className=\"formula\">Formula: {formula}</div>\n      <div className=\"result\">Result: <strong><ResultBuilder result={result} /></strong></div>\n      <div className=\"rolls\">Roll Detail: <em>{\n        Array.isArray(rolls)\n            ? rolls.length === 0 ? 'None' : rolls.join(', ')\n            : getAllRolls(rolls).length === 0 ? 'None' : getAllRolls(rolls).join(', ')\n      }</em></div>\n      {\n        active && helpers\n          ? <div className=\"input-details\">Helpers Detail: <Helpers helpers={helpers} /></div>\n          : ''\n      }\n    </li>\n  )\n};\n\nHistoryPane.propTypes = {\n  formula: PropTypes.string.isRequired,\n  result: ResultBuilder.propTypes.result,\n  rolls: PropTypes.oneOfType([\n    PropTypes.arrayOf(PropTypes.oneOfType(\n      [PropTypes.number, PropTypes.string]).isRequired).isRequired,\n    PropTypes.objectOf(PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.number, PropTypes.string]))).isRequired\n  ]).isRequired,\n  helpers: PropTypes.arrayOf(PropTypes.shape({\n    name: PropTypes.string.isRequired,\n    value: PropTypes.string.isRequired,\n    source: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)]).isRequired,\n  }).isRequired),\n};\n\nconst History = ({ clearHistory, history, scrollTo, setScrollTo }) => {\n  return (<div className=\"history\">\n    <h1>History</h1>\n    <div className=\"history-body\">\n      <ul>\n        <li>\n          <button className=\"clear-history\" onClick={clearHistory}>Clear History</button>\n        </li>\n        {\n          history.map((historyItem, i) => (\n            <HistoryPane\n              key={`history-pane-${i}`}\n              scrollTo={scrollTo===i}\n              setScrollTo={setScrollTo}\n              {...historyItem}\n            />\n          ))\n        }\n      </ul>\n    </div>\n  </div>);\n};\n\n\nHistory.propTypes = {\n  clearHistory: PropTypes.func.isRequired,\n  history: PropTypes.arrayOf(PropTypes.shape(HistoryPane.propTypes).isRequired).isRequired,\n  scrollTo: PropTypes.number,\n  setScrollTo: PropTypes.func.isRequired,\n};\n\nexport default History;\n","import React, { useEffect, useState } from 'react';\nimport FormControl from 'react-bootstrap/FormControl';\nimport PropTypes from 'prop-types';\nimport {faEdit} from '@fortawesome/free-solid-svg-icons';\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome';\nimport Button from 'react-bootstrap/Button';\nimport '../../buttons.css';\n\nconst ClickableValue = ({\n  forceEditable = false,\n  inputStyle = {},\n  onClick = null,\n  setEditing = () => {},\n  spanStyle = {},\n  updateOnBlur = false,\n  setValue,\n  value\n}) => {\n  const [isEditable, setEditableWrapped] = useState(forceEditable);\n  const setEditable = value => {\n    setEditableWrapped(value);\n    setEditing(value);\n  };\n  const [unsavedValue, setUnsavedValue] = useState(value);\n  useEffect(() => {\n    if (updateOnBlur) {\n      setUnsavedValue(value);\n    }\n  }, [updateOnBlur, value]);\n\n  const handleBlur = () => {\n    if (updateOnBlur) {\n      setValue(unsavedValue);\n    }\n    setEditable(false);\n  };\n\n  const handleChange = (event) => {\n    if (updateOnBlur) {\n      setUnsavedValue(event.target.value);\n    } else {\n      setValue(event.target.value);\n    }\n  };\n\n  const handleKeyPress = (event) => {\n    if (event.key === 'Enter') {\n      handleBlur();\n      event.preventDefault();\n    }\n  };\n\n  const handleSpanClick = (event) => {\n    if (onClick === null) {\n      setEditable(true);\n    } else {\n      onClick(event);\n    }\n  };\n  const handleEditButtonClick = event => {\n    event.preventDefault();\n    event.stopPropagation();\n    setEditable(true);\n  };\n\n  if (isEditable) {\n    return <FormControl\n      autoFocus\n      className={inputStyle}\n      onBlur={handleBlur}\n      onChange={handleChange}\n      onKeyPress={handleKeyPress}\n      style={inputStyle}\n      value={updateOnBlur ? unsavedValue : value}\n    />\n  }\n  return <>\n    <span\n      onClick={handleSpanClick}\n      style={spanStyle}\n    >\n      {value}\n    </span>\n    {\n      onClick !== null\n        ? <Button\n          onClick={handleEditButtonClick}\n          variant=\"invisible\"\n        >\n          <FontAwesomeIcon\n            icon={faEdit}\n            size=\"xs\"\n          />\n        </Button>\n        : null\n    }\n    </>;\n};\n\nClickableValue.propTypes = {\n  inputStyle: PropTypes.objectOf(PropTypes.string),\n  onClick: PropTypes.func,\n  spanStyle: PropTypes.objectOf(PropTypes.string),\n  updateOnBlur: PropTypes.bool,\n  setValue: PropTypes.func.isRequired,\n  value: PropTypes.string.isRequired,\n};\n\nexport default ClickableValue;\n","import React from 'react';\nimport { sortableHandle } from 'react-sortable-hoc';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faEllipsisV } from '@fortawesome/free-solid-svg-icons/faEllipsisV';\n\nconst DragHandle = sortableHandle(() => <FontAwesomeIcon className=\"mr-2\" icon={faEllipsisV} />);\n\nexport default DragHandle;\n","import React, { useState } from \"react\";\nimport Col from 'react-bootstrap/Col';\nimport Row from 'react-bootstrap/Row';\nimport Button from 'react-bootstrap/Button';\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\nimport ClickableValue from '../common/ClickableValue';\nimport DragHandle from '../common/DragHandle';\nimport './collectionLink.css';\n\nconst CollectionLink = ({ collectionName, duplicate, forceEditable, move, navTo, rename }) => {\n  const [renaming, setRenaming] = useState(forceEditable);\n\n  return (\n    <div className=\"list-group-item list-group-item-action\">\n      <Row>\n        <Col>\n          <h3>\n            {renaming\n              ? null\n              : <DragHandle/>\n            }\n            <ClickableValue\n              forceEditable={forceEditable}\n              onClick={navTo}\n              setEditing={setRenaming}\n              setValue={newName => rename(collectionName, newName)}\n              updateOnBlur\n              value={collectionName}\n            />\n          </h3>\n        </Col>\n        <Col>\n          <ButtonGroup>\n            <Button\n              className=\"mr-1\"\n              onClick={event => {\n                duplicate();\n                event.stopPropagation();\n              }}\n              variant=\"outline-primary\"\n            >Duplicate</Button>\n            <Button\n              onClick={event => {\n                move();\n                event.stopPropagation();\n              }}\n              variant=\"outline-warning\"\n            >Move</Button>\n          </ButtonGroup>\n        </Col>\n      </Row>\n    </div>\n  );\n};\n\nexport default CollectionLink;\n","import React, { useState } from 'react';\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome';\nimport {faEdit} from '@fortawesome/free-solid-svg-icons';\nimport PropTypes from 'prop-types';\nimport TextareaAutosize from 'react-autosize-textarea';\n\nexport const FormulaEditor = ({\n  controlled = true,\n  editButton,\n  formula,\n  name,\n  readOnlyProp,\n  saveRoll,\n  setReadOnlyProp\n}) => {\n  const [readOnly, setReadOnly] = useState(true);\n  const [editedFormulaValue, setEditedFormulaValue] = useState(formula);\n\n  const isReadOnly = () => readOnlyProp != null ? readOnlyProp : readOnly;\n\n  const makeWriteable = () => {\n    if (!controlled) {\n      setEditedFormulaValue(formula);\n    }\n    setReadOnly(false);\n    if (typeof setReadOnlyProp === 'function') {\n      setReadOnlyProp(false);\n    }\n  };\n  const makeReadOnly = () => {\n    if (!controlled && formula !== editedFormulaValue) {\n      saveRoll({ name, formula: editedFormulaValue });\n    }\n    setReadOnly(true);\n    if (typeof setReadOnlyProp === 'function') {\n      setReadOnlyProp(true);\n    }\n  };\n  const onChangeEventHandler = (event) => {\n    if (controlled) {\n      saveRoll({name, formula: event.target.value})\n    } else {\n      setEditedFormulaValue(event.target.value);\n    }\n  };\n\n  return isReadOnly()\n    ? (<span\n      className=\"formula\"\n      onClick={makeWriteable}\n    >\n      {formula}\n      {\n        editButton\n          ? <FontAwesomeIcon\n            className=\"ml-2\"\n            icon={faEdit}\n          />\n          : null\n      }\n    </span>)\n    : (\n      <TextareaAutosize\n        autoFocus\n        className=\"formula-editor\"\n        onBlur={makeReadOnly}\n        onChange={onChangeEventHandler}\n        type=\"text\"\n        value={controlled ? formula : editedFormulaValue}\n      />\n      );\n};\n\nFormulaEditor.propTypes = {\n  controlled: PropTypes.bool,\n  editButton: PropTypes.bool,\n  formula: PropTypes.string.isRequired,\n  name: PropTypes.string.isRequired,\n  readOnlyProp: PropTypes.bool,\n  saveRoll: PropTypes.func.isRequired,\n  setReadOnlyProp: PropTypes.func,\n};\n","import React from 'react';\nimport Dropdown from 'react-bootstrap/Dropdown';\nimport DropdownButton from 'react-bootstrap/DropdownButton';\n\n// currently just a drop down but should do more later\n\nconst CollectionChooserButton = ({ collections, chosenCollection, setChosenCollection }) => {\n  return (\n    <DropdownButton\n      title={chosenCollection || <em>Choose Collection</em>}\n    >\n      <Dropdown.Item\n        onClick={() => setChosenCollection('')}\n      >None</Dropdown.Item>\n      {\n        Object.entries(collections).map(([collection], i) => (\n          <Dropdown.Item\n            key={`coll-${i}`}\n            onClick={() => setChosenCollection(collection)}\n          >{collection}</Dropdown.Item>\n        ))\n      }\n    </DropdownButton>\n  );\n};\n\nexport default CollectionChooserButton;\n","/**\n * This helper enables mapping over the entries in an object that is being used like a Map.\n * @example\n * // returns { a: 2, b: 4 }\n * Object.entries({ a: 1, b: 2 }).map(([k,v]) => [k, v*2]).reduce(objectMakerReducerHelper, {})\n * @param {object} accum (Accumulator) This accumulates the return values of this function\n * @param {[string, *]} currentValue The next key-value pair to be added to the accumulator\n * @returns {object}\n */\nexport const objectMakerReduceHelper = (accum, [key, val]) => ({ ...accum, [key]: val });\n\n/**\n * Immutably removes a key from an object\n * @example\n * // returns { a: 1 }\n * removeFromObject('b', { a: 1, b: 2 })\n *\n * @param {string} key The key to remove\n * @param {object} obj The object to update\n * @returns {object} A copy of obj, with the named key removed\n */\nexport const removeFromObject = (key, { [key]: _, ...otherEntities }) => ({ ...otherEntities });\n\n/**\n * Immutably renames a key in an object. WARNING: Key order is not preserved.\n * @param {string} oldKey\n * @param {string} newKey\n * @param {object} obj\n * @returns {object} obj, with oldKey:value removed and newKey:value added\n */\nexport const renameObjectKey = (oldKey, newKey, { [oldKey]: value, ...otherEntities}) => (\n  {\n    [newKey]: value,\n    ...otherEntities\n  }\n);\n\n/**\n * Immutably renames a key in an object without potentially changing the keys' order\n * @param {string} oldKey\n * @param {string} newKey\n * @param {object} obj\n * @returns {object} obj, with oldKey:value removed and newKey:value added, and with order preserved\n */\nexport const renameObjectKeyPreserveOrder = (oldKey, newKey, obj) =>\n  Object.entries(obj)\n    .map(([key, val]) => key === oldKey ? [newKey, val] : [key, val])\n    .reduce(objectMakerReduceHelper, {});\n\n/**\n * Descend into a nested object/array by following the path provided. Fallback to undefined.\n * @example // returns 'bar'\n * getPropertyByPath({a:{b:[['foo','bar']]}}, ['a','b',0,1])\n *\n * @param {object|Array|*} value\n * @param {string[]} path\n * @returns {undefined|*}\n */\nexport const getPropertyByPath = (value, path) =>\n  (path.length === 0\n    ? value\n    : value && typeof value === 'object'\n      ? getPropertyByPath(value[path[0]], path.slice(1))\n      : undefined);\n\n/**\n * Given an object and a desired key name, find the first instance of `${name}` or `${name} ${number}`\n * that isn't already taken.\n * @example // returns 'Corvec 2'\n * getUniqueName('Corvec', { Corvec: 100, 'Corvec 1': 50 })\n *\n * @param {string} name\n * @param {object} container\n * @returns {string}\n */\nexport const getUniqueName = (name, container) => {\n  if (!container.hasOwnProperty(name)) {\n    return name;\n  }\n\n  const getName = i => `${name} ${i}`;\n  const getNextName = i =>\n    container.hasOwnProperty(getName(i))\n      ? getNextName(i+1)\n      : getName(i);\n  return getNextName(1);\n};\n","import React from 'react';\nimport Modal from 'react-bootstrap/Modal';\nimport Button from 'react-bootstrap/Button';\n\nconst ConfirmationModal = ({ action, show, setShow, text, title = 'Are you sure?' }) => {\n  const handleCancel = () => setShow(false);\n  const handleOK = () => {\n    action();\n    setShow(false);\n  };\n\n  if (!show) {\n    return null;\n  }\n\n  return (<Modal show={show} onHide={handleCancel}>\n    <Modal.Header closeButton>\n      <Modal.Title>{title}</Modal.Title>\n    </Modal.Header>\n    <Modal.Body>{text}</Modal.Body>\n    <Modal.Footer>\n      <Button variant=\"secondary\" onClick={handleCancel}>\n        Cancel\n      </Button>\n      <Button variant=\"danger\" onClick={handleOK}>\n        OK\n      </Button>\n    </Modal.Footer>\n  </Modal>);\n};\n\nexport default ConfirmationModal;\n","import React from 'react';\nimport Button from 'react-bootstrap/Button';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faDice } from '@fortawesome/free-solid-svg-icons';\n\nconst RollButton = ({\n  hasMissingVariables,\n  onlyUnknownVariable,\n  roll,\n  size = \"lg\",\n  suppliedValues,\n  targetCollections,\n  valuesFromTargetedCollections,\n}) => (<Button\n  block\n  className={size === 'lg' ? \"mr-1 p-4\" : \"\"}\n  disabled={hasMissingVariables}\n  onClick={event => {\n    event.stopPropagation();\n    if (onlyUnknownVariable) {\n      roll({\n        ...suppliedValues,\n        ...valuesFromTargetedCollections,\n        [onlyUnknownVariable]: '?',\n      }, targetCollections);\n    } else {\n      roll({ ...suppliedValues, ...valuesFromTargetedCollections }, targetCollections);\n    }\n  }}\n  size={size}\n  title=\"Roll!\"\n  variant=\"outline-primary\"\n>\n  <FontAwesomeIcon\n    className={hasMissingVariables ? 'secondary' : 'success'}\n    icon={faDice}\n    size=\"2x\"\n  />\n</Button>);\n\nexport default RollButton;\n","import React from \"react\";\nimport { Form, FormControl } from \"react-bootstrap\";\nimport InputGroup from \"react-bootstrap/InputGroup\";\n\n// child of SavedRoll\n\nconst VariableEntry = ({\n  onlyUnknownVariable,\n  rollMetadata,\n  setSuppliedValues,\n  suppliedValues,\n  valuesFromTargetedCollections\n}) => (\n  <Form>\n    <Form.Group>\n      <Form.Label column={false}>Unknown variables</Form.Label>\n      {rollMetadata.unknownVariables.map((variableName, i) => (\n        <InputGroup key={`unknown-${i}`}>\n          <InputGroup.Prepend>\n            <InputGroup.Text>{variableName}</InputGroup.Text>\n          </InputGroup.Prepend>\n          <FormControl\n            className=\"unknown-variable-value\"\n            onChange={e =>\n              setSuppliedValues({\n                ...suppliedValues,\n                [variableName]: e.target.value\n              })\n            }\n            placeholder={\n              rollMetadata.noPromptVariables.includes(variableName)\n                ? \"0\"\n                : onlyUnknownVariable === variableName\n                  ? \"?\"\n                  : null\n            }\n            readOnly={valuesFromTargetedCollections.hasOwnProperty(\n              variableName\n            )}\n            value={\n              valuesFromTargetedCollections.hasOwnProperty(variableName)\n                ? valuesFromTargetedCollections[variableName]\n                : suppliedValues[variableName] || \"\"\n            }\n          />\n        </InputGroup>\n      ))}\n    </Form.Group>\n  </Form>\n);\n\nexport default VariableEntry;\n","import React, { useEffect, useRef, useState } from 'react';\nimport PropTypes from 'prop-types';\nimport { FormulaEditor } from './FormulaEditor';\nimport CollectionChooserButton from './CollectionChooserButton';\nimport { objectMakerReduceHelper } from '../../lib/helpers';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Card from 'react-bootstrap/Card';\nimport Badge from 'react-bootstrap/Badge';\nimport {Form} from 'react-bootstrap';\nimport InputGroup from 'react-bootstrap/InputGroup';\nimport Button from 'react-bootstrap/Button';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport {\n  faCalculator,\n  faClone,\n  faTrashAlt,\n  faEquals,\n  faHistory,\n} from '@fortawesome/free-solid-svg-icons';\nimport '../../icons.css';\nimport './savedRoll.css';\nimport { formulaTokenizer, formulaValidator } from 'roll-a-d6';\nimport ResultBuilder, { resultPropType } from '../common/ResultBuilder';\nimport ClickableValue from '../common/ClickableValue';\nimport DragHandle from '../common/DragHandle';\nimport ConfirmationModal from '../common/ConfirmationModal';\nimport RollButton from './RollButton';\nimport VariableEntry from './VariableEntry';\n\nconst { getTargetCollection, stripPrefix, stripSuffix } = formulaTokenizer;\n\nconst SavedRoll = ({\n  activateFormulaInCalculator,\n  childCollections,\n  clone,\n  collapsed,\n  convertPathStringToPathArray,\n  formula,\n  getCollectionByPath,\n  gotoResultInHistory,\n  name,\n  remove,\n  rename,\n  roll,\n  rollMetadata,\n  result,\n  saveRoll,\n  scrollTo,\n  setScrollTo,\n}) => {\n\n  // values supplied by user or by chosen collections in the \"unknown variables\" section\n  const [suppliedValues, setSuppliedValues] = useState({});\n  // selected target collections\n  const [targetCollections, setTargetCollections] = useState({});\n  const [renaming, setRenaming] = useState(false);\n  const [modalProperties, setModalProperties] = useState({\n     action: () => {}, show: false, text: ''\n  });\n  const doWithConfirmation = (action, text) => setModalProperties({\n    action,\n    show: true,\n    text\n  });\n\n  const ref = useRef(null);\n  useEffect(() => {\n    if (scrollTo) {\n      setRenaming(true);\n      ref.current.scrollIntoView({\n        behavior: 'smooth',\n        block: 'start',\n      });\n      return () => {\n        setScrollTo(null);\n      }\n    }\n  }, [ref, scrollTo, setScrollTo]);\n\n  const valuesFromTargetedCollections = Object.entries(targetCollections).map(\n    ([targetName, targetCollectionName]) => Object.entries(\n      getCollectionByPath(convertPathStringToPathArray(targetCollectionName)).rolls)\n      .filter(([name]) =>\n        rollMetadata.unknownVariables.some(variable =>\n          getTargetCollection(variable) === targetName\n          && name === stripPrefix(stripSuffix(variable))\n        ))\n      .map(([name, formula]) => [`${name}@${targetName}`, formula])\n  ).flat().reduce(objectMakerReduceHelper, {});\n\n  const chosenCollectionSetter = targetCollection => chosenCollection => {\n    setTargetCollections({\n      ...targetCollections,\n      [targetCollection]: chosenCollection,\n    });\n    if (chosenCollection !== ''\n      && !rollMetadata.targetedCollections[targetCollection].some(\n        valueName => childCollections[chosenCollection].rolls.hasOwnProperty(valueName)\n      )) {\n      window.alert('The selected collection does not have any of the needed values.')\n    }\n  };\n\n  const hasVariables =\n    Object.entries(rollMetadata.targetedCollections).length > 0 ||\n    rollMetadata.unknownVariables.length > 0;\n\n  const missingVariables = rollMetadata.unknownVariables\n      .filter(variable =>\n        !(rollMetadata.noPromptVariables.includes(variable)\n          && (typeof suppliedValues[variable] !== 'string' || suppliedValues[variable].length === 0))\n        && !(typeof suppliedValues[variable] === 'string' && formulaValidator.validateClause(suppliedValues[variable], 0))\n        && !(Object.keys(valuesFromTargetedCollections).includes(variable))\n      );\n\n\n  const hasMissingVariables = missingVariables.length > 1 ||\n    (missingVariables.length === 1 &&\n      Object.values(suppliedValues).some(value => value === '?')\n    );\n  const onlyUnknownVariable = !hasMissingVariables && missingVariables.length === 1\n    ? missingVariables[0]\n    : null;\n\n  const rollButtonProps = {\n    hasMissingVariables,\n    onlyUnknownVariable,\n    roll,\n    suppliedValues,\n    targetCollections,\n    valuesFromTargetedCollections,\n  };\n\n  if (collapsed) {\n    return (\n      <Card className=\"saved-roll\" ref={ref}>\n        <Card.Header><DragHandle />{name}</Card.Header>\n        <Card.Body>\n          <RollButton {...rollButtonProps} size=\"xs\" />\n          {result\n            ? <Badge\n              style={{ width: '100%' }}\n              title=\"Last rolled result\"\n              variant=\"success\"\n            >\n              <ResultBuilder result={result}/>\n            </Badge>\n            : null\n          }\n        </Card.Body>\n      </Card>\n    );\n  }\n\n  return (<>\n    <Card className=\"saved-roll\" ref={ref}>\n      <Card.Header\n        as=\"h4\"\n      >\n        {!renaming && <DragHandle/>}\n        <ClickableValue\n          forceEditable={scrollTo}\n          setEditing={setRenaming}\n          updateOnBlur\n          setValue={newName => rename(name, newName)}\n          value={name}\n        />\n        {!renaming && <FontAwesomeIcon\n          className=\"danger trash-button\"\n          icon={faTrashAlt}\n          onClick={() => doWithConfirmation(remove, 'Click OK to delete this roll.')}\n          title=\"Delete this saved roll\"\n        />}\n      </Card.Header>\n      <Card.Body>\n        <Row>\n          {\n            hasVariables\n            &&\n            <Col>\n              {\n                Object.entries(rollMetadata.targetedCollections).length === 0\n                  ? null\n                  : (<Form>\n                    <Form.Group>\n                      <Form.Label>Target Collections</Form.Label>\n                      {\n                        Object.entries(rollMetadata.targetedCollections).map(([ targetName ], i) =>\n                          (<InputGroup\n                            key={`unk-coll-${i}`}\n                            as={Row}\n                          >\n                            <InputGroup.Prepend>\n                              <InputGroup.Text>\n                                {targetName}\n                              </InputGroup.Text>\n                            </InputGroup.Prepend>\n                            <CollectionChooserButton\n                              collections={childCollections}\n                              chosenCollection={targetCollections[ targetName ]}\n                              setChosenCollection={chosenCollectionSetter(targetName)}\n                            />\n                          </InputGroup>))\n                      }</Form.Group></Form>)\n              }\n              {\n                rollMetadata.unknownVariables.length === 0\n                  ? null\n                  : <VariableEntry\n                    onlyUnknownVariable={onlyUnknownVariable}\n                    rollMetadata={rollMetadata}\n                    setSuppliedValues={setSuppliedValues}\n                    suppliedValues={suppliedValues}\n                    valuesFromTargetedCollections={valuesFromTargetedCollections}\n                  />\n              }\n            </Col>\n          }\n          <Col md={hasVariables ? 'auto' : null}>\n            <Row>\n              <RollButton {...rollButtonProps} size=\"lg\" />\n            </Row>\n            {\n              result\n                ? <Row className=\"mt-1\">\n                  <Badge\n                    style={{ width: '100%' }}\n                    title=\"Last rolled result\"\n                    variant=\"success\"\n                  >\n                    <FontAwesomeIcon\n                      className=\"float-left\"\n                      icon={faEquals}\n                    />\n                    <ResultBuilder result={result} />\n                    {\n                      typeof gotoResultInHistory === 'function'\n                        ? <FontAwesomeIcon\n                          className=\"float-right\"\n                          icon={faHistory}\n                          onClick={gotoResultInHistory}\n                          title=\"Click to go to result in History\"\n                        />\n                        : null\n                    }\n                  </Badge>\n                </Row>\n                : null\n            }\n          </Col>\n        </Row>\n      </Card.Body>\n      <Card.Footer className=\"text-muted\">\n        <FormulaEditor\n          activateFormulaInCalculator={activateFormulaInCalculator}\n          controlled={false}\n          editButton={true}\n          formula={formula}\n          name={name}\n          saveRoll={saveRoll}\n        />\n        <Button\n          className=\"ml-2\"\n          onClick={activateFormulaInCalculator}\n          variant=\"outline-info\"\n        >\n          <FontAwesomeIcon\n            alt=\"Load in calculator\"\n            icon={faCalculator}\n          />\n        </Button>\n        <Button\n          className=\"float-right\"\n          onClick={clone}\n          variant=\"outline-secondary\"\n        >\n          <FontAwesomeIcon\n            alt=\"Duplicate this saved roll\"\n            icon={faClone}\n          />\n        </Button>\n      </Card.Footer>\n    </Card>\n    <ConfirmationModal\n      setShow={show => setModalProperties({ ...modalProperties, show })}\n      {...modalProperties}\n    />\n  </>);\n};\n\nSavedRoll.propTypes = {\n  activateFormulaInCalculator: PropTypes.func.isRequired,\n  childCollections: PropTypes.object,\n  clone: PropTypes.func.isRequired,\n  formula: PropTypes.string.isRequired,\n  gotoResultInHistory: PropTypes.func,\n  name: PropTypes.string.isRequired,\n  remove: PropTypes.func.isRequired,\n  rename: PropTypes.func.isRequired,\n  roll: PropTypes.func.isRequired,\n  rollMetadata: PropTypes.object.isRequired,\n  result: resultPropType,\n  saveRoll: PropTypes.func.isRequired,\n  scrollTo: PropTypes.bool,\n  setScrollTo: PropTypes.func,\n};\n\nexport default SavedRoll;\n","import React, {useState} from 'react';\nimport { FormulaEditor } from './FormulaEditor';\nimport Card from 'react-bootstrap/Card';\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome';\nimport { faTrashAlt } from '@fortawesome/free-solid-svg-icons';\nimport ClickableValue from '../common/ClickableValue';\nimport DragHandle from '../common/DragHandle';\nimport ConfirmationModal from '../common/ConfirmationModal';\n\nconst SavedValue = ({ activateFormulaInCalculator, formula, name, remove, rename, rollMetadata, saveRoll }) => {\n  const [editableFormula, setEditableFormula] = useState(false);\n  const [renaming, setRenaming] = useState(false);\n  const [modalProperties, setModalProperties] = useState({\n    action: () => {}, show: false, text: ''\n  });\n  const doWithConfirmation = (action, text) => setModalProperties({\n    action,\n    show: true,\n    text\n  });\n  const hideValue = rollMetadata.value.join(',') === formula;\n  return (<>\n    <Card className=\"mr-1 mb-1\">\n      <Card.Header>\n        {!renaming && <DragHandle/>}\n        <ClickableValue\n          updateOnBlur\n          setEditing={setRenaming}\n          setValue={newName => rename(name, newName)}\n          value={name}\n        />\n        {!renaming && <FontAwesomeIcon\n          className=\"danger trash-button\"\n          icon={faTrashAlt}\n          onClick={() => doWithConfirmation(remove, \"Click OK to delete this saved value.\")}\n          title=\"Delete this saved value\"\n        />}\n      </Card.Header>\n      <Card.Body>\n        {\n          hideValue\n            ? null\n            : <Card.Title\n              onClick={activateFormulaInCalculator}\n            >{rollMetadata.value.join(', ')}\n            </Card.Title>\n        }\n\n        <Card.Text\n          className=\"text-muted\"\n        >\n          <FormulaEditor\n            controlled={false}\n            editButton={true}\n            formula={formula}\n            name={name}\n            saveRoll={saveRoll}\n            readOnlyProp={!editableFormula}\n            setReadOnlyProp={ro => setEditableFormula(!ro)}\n          />\n        </Card.Text>\n      </Card.Body>\n    </Card>\n    <ConfirmationModal\n      setShow={show => setModalProperties({ ...modalProperties, show })}\n      {...modalProperties}\n    />\n  </>);\n};\n\nexport default SavedValue;\n","import React from 'react';\nimport Card from 'react-bootstrap/Card';\n\nconst CollapsedSavedValue = ({ name, value, ...props }) => (\n  <Card>\n    <Card.Body {...props}>\n      {name}: {value}\n    </Card.Body>\n  </Card>\n);\n\nexport default CollapsedSavedValue;\n","import React from 'react';\n\n/**\n * @param {React.ReactNode} children\n * @returns {React.Component}\n */\nconst defaultContainer = ({ children }) => <li>{children}</li>;\n\n/**\n * @typedef TreeViewNode\n * @type {object}\n * @property {string|React.Component} node When this node is displayed, what to show\n * @property {Array.<object.<string, TreeViewTree>>} children Descendants of this node\n */\n\n/**\n * @typedef TreeViewTree\n * @type {Array.<TreeViewNode>}\n */\n\n/**\n * Generate a tree view component, e.g., a folder structure.\n *\n * @example\n * TreeView({ data: {\n *   node: 'root',\n *   children: [\n *     Shared: {\n *       node: 'Shared',\n *       children: [],\n *     }\n *   ]\n * } })\n *\n * @param {object} props - React Props\n * @param {React.ReactNode} props.Container - A component to nest the nodes within\n * @param {TreeViewTree} props.data - The tree to display\n * @returns {React.Component}\n */\nconst TreeView = ({ Container = defaultContainer, data }) => (\n  <ul className=\"treeview\">{\n    data.map(({ children, node }, i) => (\n      <Container key={i}>\n        {node}\n        {children\n          ? <TreeView Container={Container} data={children} />\n          : null}\n      </Container>\n    ))\n  }</ul>\n);\n\nexport default TreeView;\n","import React from 'react';\nimport TreeView from './TreeView';\n\nconst CollectionNode = ({ action, children }) => (\n  <button className=\"list-group-item list-group-item-action\" onClick={action}>\n    {children}\n  </button>\n);\n\nconst logCollectionSelector = false;\nconst log = message => {\n  if (logCollectionSelector) {\n    console.log(message);\n  }\n};\n\nconst CollectionTreeViewSelector = ({ collections, pathToExclude, selectCollection }) => {\n  const collectionReduceHelper = path => (accum, [collectionName, collection]) => {\n    const collectionPath = `${path}/${collectionName}`;\n    if (pathToExclude === collectionPath) {\n      log('Excluded path found');\n      return accum;\n    }\n    log(`Path: ${collectionPath}`);\n    return [\n      ...accum,\n      {\n        collectionPath,\n        node: <CollectionNode\n          key={`cnode-${collectionPath}`}\n          action={() => selectCollection(collectionPath)}\n        >{collectionName}</CollectionNode>,\n        children: Object.entries(collection.collections)\n          .reduce(collectionReduceHelper(collectionPath), []),\n      },\n    ];\n  };\n  const treeViewData = {\n    collectionPath: '/',\n    node: <CollectionNode\n      key=\"cnode-Root\"\n      action={() => selectCollection('/')}\n    >Root</CollectionNode>,\n    children: Object.entries(collections.Root.collections)\n      .reduce(collectionReduceHelper(''), []),\n  };\n\n  return <TreeView \n    Container={({ children }) => <div className=\"list-group\">{children}</div>}\n    data={[treeViewData]}\n  />;\n};\n\nexport default CollectionTreeViewSelector;\n","import React from 'react';\nimport Alert from 'react-bootstrap/Alert';\n\nconst ErrorMessage = ({ errorMessage, setErrorMessage }) => (\n  errorMessage\n    ? <Alert\n      dismissible\n      onClose={() => setErrorMessage(null)}\n      variant=\"danger\"\n    >\n      {errorMessage}\n    </Alert>\n    : null\n);\n\nexport default ErrorMessage;\n","import React, { useState } from 'react';\nimport Button from 'react-bootstrap/Button';\nimport Modal from 'react-bootstrap/Modal';\nimport CollectionTreeViewSelector from './CollectionTreeViewSelector';\nimport ErrorAlert from './ErrorAlert';\n\nconst SelectCollectionModal = ({ action, collections, pathToExclude, show, setShow, title = 'Select Collection' }) => {\n  const [errorMessage, setErrorMessage] = useState(null);\n  const handleCancel = () => setShow(false);\n  const handleOK = (collectionPath) => {\n    try {\n      action(collectionPath);\n      setShow(false);\n    } catch (err) {\n      setErrorMessage(err.message);\n    }\n  };\n\n  if (!show) {\n    return null;\n  }\n\n  return (<Modal show={show} onHide={handleCancel}>\n    <Modal.Header closeButton>\n      <Modal.Title>{title}</Modal.Title>\n    </Modal.Header>\n    <Modal.Body>\n      <ErrorAlert {...{errorMessage, setErrorMessage}} />\n      <CollectionTreeViewSelector\n        {...{\n          collections,\n          pathToExclude\n        }}\n        selectCollection={collectionPath => handleOK(collectionPath)}\n      />\n    </Modal.Body>\n    <Modal.Footer>\n      <Button variant=\"secondary\" onClick={handleCancel}>\n        Cancel\n      </Button>\n    </Modal.Footer>\n  </Modal>);\n};\n\nexport default SelectCollectionModal;\n","import React, { useState } from 'react';\nimport PropTypes from 'prop-types';\nimport CollectionLink from \"./CollectionLink\";\nimport SavedRoll from \"./SavedRoll\";\nimport SavedValue from './SavedValue';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Col from 'react-bootstrap/Col';\nimport Button from 'react-bootstrap/Button';\nimport Breadcrumb from 'react-bootstrap/Breadcrumb';\nimport {sortableContainer, sortableElement} from 'react-sortable-hoc';\nimport {FontAwesomeIcon} from '@fortawesome/react-fontawesome';\nimport { faCompressArrowsAlt } from '@fortawesome/free-solid-svg-icons/faCompressArrowsAlt';\nimport { faExpandArrowsAlt } from '@fortawesome/free-solid-svg-icons/faExpandArrowsAlt';\nimport CollapsedSavedValue from './CollapsedSavedValue';\nimport ConfirmationModal from '../common/ConfirmationModal';\nimport SelectCollectionModal from '../common/SelectCollectionModal';\n\nconst SortableRow = sortableContainer(({ ...props }) => (<Row {...props} />));\nconst SortableDivContainer = sortableContainer(({ ...props }) => <div {...props} />);\nconst SortableCollectionLink = sortableElement(({ ...props }) => <CollectionLink {...props} />);\nconst SortableSavedValue = sortableElement(({ ...props }) => (<SavedValue {...props} />));\nconst SortableSavedRoll = sortableElement(({ ...props }) => (<SavedRoll {...props} />));\nconst SortableCollapsedValue = sortableElement(({ ...props }) => (<CollapsedSavedValue {...props} />));\n\nconst Collections = ({ collectionState, history, roll, saveRoll, selectCalculator, selectHistory, setFormula }) => {\n  const [newCollectionName, setNewCollectionName] = useState(null);\n  const [newRollName, setNewRollName] = useState(null);\n  const [collapsed, setCollapsed] = useState({ rolls: false, values: false });\n  const [modalProperties, setModalProperties] = useState({\n    action: () => {}, show: false, text: ''\n  });\n  const doWithConfirmation = (action, text) => setModalProperties({\n    action,\n    show: true,\n    text\n  });\n  const [selectCollectionProperties, setSelectCollectionProperties] = useState({\n    action: () => {},\n    collections: collectionState.collections,\n    show: false,\n  });\n  const moveCollectionWithModal = (collectionToMove) => setSelectCollectionProperties({\n    ...selectCollectionProperties,\n    action: (destination) => collectionState.move(collectionToMove, destination),\n    pathToExclude: `${collectionState.activeCollection.join('/')}/${collectionToMove}`.replace(/^Root\\//, '/'),\n    show: true,\n    title: `Move ${collectionToMove}`,\n  });\n\n  const activate = formula => () => {\n    setFormula(formula);\n    selectCalculator();\n  };\n  const removeRoll = name => () => {\n    collectionState.removeRoll(name);\n  };\n  const rollHandler = ({ name, formula }) => (suppliedValues, targetCollections) => {\n    const successCallback = ({ result, rolls, sideEffects }) => {\n      collectionState.setLastRoll({\n        historyIndex: history.length - 1,\n        name,\n        result,\n        rolls,\n        sideEffects,\n        targetCollections\n      });\n    };\n    const suppliedString = Object.entries(suppliedValues)\n      .filter(([, value]) => value.length > 0)\n      .map(([name, value]) => `,${name}=${value}`)\n      .join('');\n    const sentFormula = `${formula}${suppliedString}`;\n    roll(sentFormula, successCallback);\n  };\n  const CollapseButton = ({ collection }) => (<Button\n    className=\"btn-left-of-row\"\n    onClick={() => setCollapsed({ ...collapsed, [collection]: true })}\n    variant=\"outline-info\"\n  ><FontAwesomeIcon icon={faCompressArrowsAlt} />\n  </Button>);\n  const ExpandButton = ({ collection }) => (<Button\n    className=\"btn-left-of-row\"\n    onClick={() => setCollapsed({ ...collapsed, [collection]: false })}\n    variant=\"outline-info\"\n  ><FontAwesomeIcon icon={faExpandArrowsAlt} />\n  </Button>);\n\n  const {\n    activeCollection,\n    currentCollection,\n    getRollsWithDetails,\n    removeCurrentCollection,\n    renameCurrentCollection,\n  } = collectionState;\n\n  const rollMetadata = getRollsWithDetails();\n\n  const rollsAndValues = Object.entries(currentCollection.rolls);\n  const rolls = rollsAndValues.filter(([name]) =>\n    rollMetadata[name].type !== 'value'\n  );\n  const values = rollsAndValues.filter(([name]) =>\n    rollMetadata[name].type === 'value'\n  );\n\n  const getRollInfo = roll => (typeof roll === 'string'\n    ? { formula: roll }\n    : {\n      ...roll,\n      gotoResultInHistory: roll.historyIndex\n        ? () => {\n          selectHistory(roll.historyIndex + 1);\n        }\n        : null,\n    });\n\n  const handleMoveCollection = ({ oldIndex, newIndex }) => {\n    if (typeof oldIndex !== 'number' || oldIndex < 0 || oldIndex > values.length) {\n      return;\n    }\n    const collectionName = Object.entries(currentCollection.collections)[oldIndex][0];\n    collectionState.moveChildCollection(collectionName, newIndex);\n  };\n  const handleMoveSavedItem = collectionType => {\n    const collection = { rolls, values }[collectionType];\n    return ({ oldIndex, newIndex }) => {\n      if (typeof oldIndex !== 'number' || oldIndex < 0 || oldIndex > values.length) {\n        return;\n      }\n      const itemName = collection[oldIndex][0];\n      const destName = collection[newIndex][0];\n      const newIndexInFullList = rollsAndValues.findIndex(([name]) => name === destName);\n      collectionState.moveRoll(itemName, newIndexInFullList);\n    };\n  };\n\n  return (\n    <Container>\n      <h1>Collections</h1>\n      {\n        activeCollection.length === 0\n          ? null\n          :\n          <Breadcrumb>{activeCollection.map(\n            (collectionName, i) => {\n              if (i < activeCollection.length - 1) {\n                return (<Breadcrumb.Item\n                  key={i}\n                  href={`#${collectionName}`}\n                  onClick={() => collectionState.navigateToParent(activeCollection.length - i - 1)}\n                >{collectionName}</Breadcrumb.Item>);\n              } else {\n                return (<Breadcrumb.Item key={i} active>{collectionName}</Breadcrumb.Item>);\n              }\n            }\n          )}\n          </Breadcrumb>\n      }\n      <Row className=\"mb-2\">\n        <Col>\n          <Button\n            onClick={() => setNewCollectionName(collectionState.createCollection())}\n            variant=\"primary\"\n          >Create Child Collection</Button>\n        </Col>\n        {activeCollection.length <= 1\n          ? null\n          : <>\n            <Col>\n              <Button\n                onClick={() => doWithConfirmation(removeCurrentCollection, \"Click OK to delete this collection.\")}\n                variant=\"danger\"\n              >Remove Current Collection</Button>\n            </Col>\n            <Col>\n              <Button\n                onClick={renameCurrentCollection}\n                variant=\"secondary\"\n              >Rename Current Collection</Button>\n            </Col>\n          </>\n        }\n      </Row>\n      <SortableDivContainer\n        className=\"list-group\"\n        onSortEnd={handleMoveCollection}\n        useDragHandle\n      >\n        {Object.entries(currentCollection.collections).map(\n          ([collectionName, coll], i) => (\n            <SortableCollectionLink\n              key={collectionName}\n              collectionName={collectionName}\n              duplicate={() => collectionState.duplicate(collectionName)}\n              forceEditable={collectionName === newCollectionName}\n              index={i}\n              move={() => moveCollectionWithModal(collectionName)}\n              navTo={() => collectionState.navigateTo(collectionName)}\n              rename={collectionState.renameChildCollection}\n            />\n          ))}\n      </SortableDivContainer>\n      <h3 className=\"mt-4\">Saved Rolls and Values</h3>\n      <Button\n        block\n        onClick={() => setNewRollName(collectionState.createRoll())}\n        variant=\"success\"\n      >Create Roll</Button>\n      {values.length === 0 ? null : !collapsed.values\n        ? <SortableRow\n          axis=\"xy\"\n          className=\"mt-3\"\n          onSortEnd={handleMoveSavedItem('values')}\n          useDragHandle\n        >\n          <CollapseButton collection=\"values\" />\n          {values.map(([ name, roll ], valueIndex) => {\n            const formula = typeof roll === 'string' ? roll : roll.formula;\n            return (\n              <SortableSavedValue\n                key={name}\n                activateFormulaInCalculator={activate(formula)}\n                formula={formula}\n                index={valueIndex}\n                name={name}\n                remove={removeRoll(name)}\n                rename={collectionState.renameRoll}\n                rollMetadata={rollMetadata[ name ]}\n                saveRoll={saveRoll}\n                value={rollMetadata[ name ].value}\n              />\n            );\n          })}\n        </SortableRow>\n        : <SortableRow\n          axis=\"xy\"\n          className=\"mt-3\"\n          onSortEnd={handleMoveSavedItem('values')}\n        >\n          <ExpandButton collection=\"values\" />\n          {values.map(([ name, roll ], valueIndex) => (\n            <SortableCollapsedValue\n              key={name}\n              index={valueIndex}\n              name={name}\n              value={rollMetadata[name].value.join(', ')}\n            />\n          ))}\n        </SortableRow>\n      }\n      {rolls.length > 0\n        ?\n        <SortableRow\n          axis=\"xy\"\n          className=\"mt-2\"\n          onSortEnd={handleMoveSavedItem('rolls')}\n          useDragHandle\n        >\n          {collapsed.rolls\n            ? <ExpandButton collection=\"rolls\"/>\n            : <CollapseButton collection=\"rolls\"/>\n          }\n          {rolls.map(([name, roll], rollIndex) => {\n            const {formula, result, gotoResultInHistory} = getRollInfo(roll);\n            return (<SortableSavedRoll\n                key={name}\n                activateFormulaInCalculator={activate(formula)}\n                childCollections={currentCollection.collections}\n                clone={() => collectionState.cloneRoll(name)}\n                collapsed={collapsed.rolls}\n                convertPathStringToPathArray={collectionState.convertPathStringToPathArray}\n                formula={formula}\n                getCollectionByPath={collectionState.getCollectionByPath}\n                gotoResultInHistory={gotoResultInHistory}\n                index={rollIndex}\n                move={newIndex => collectionState.moveRoll(name, newIndex)}\n                name={name}\n                rename={collectionState.renameRoll}\n                remove={removeRoll(name)}\n                result={result}\n                roll={rollHandler({name, formula})}\n                rollMetadata={rollMetadata[name]}\n                saveRoll={saveRoll}\n                scrollTo={newRollName === name}\n                setScrollTo={setNewRollName}\n              />\n            );\n          })}\n        </SortableRow>\n        : null\n      }\n      <ConfirmationModal\n        setShow={show => setModalProperties({ ...modalProperties, show })}\n        {...modalProperties}\n      />\n      <SelectCollectionModal\n        setShow={show => setSelectCollectionProperties({\n          ...selectCollectionProperties,\n          show\n        })}\n        {...selectCollectionProperties}\n      />\n    </Container>\n  );\n};\n\nCollections.propTypes = {\n  collectionState: PropTypes.object.isRequired,\n  roll: PropTypes.func.isRequired,\n  saveRoll: PropTypes.func.isRequired,\n  selectCalculator: PropTypes.func.isRequired,\n  selectHistory: PropTypes.func.isRequired,\n  setFormula: PropTypes.func.isRequired,\n};\nexport default Collections;\n","import Collections from './Collections';\n\nexport default Collections;\n\n","import { useState } from 'react';\n\nconst fetchFromLocalStorage = (key, defaultValue) => {\n  const value = localStorage.getItem(key);\n  return value ? JSON.parse(value) : defaultValue;\n};\n\nconst setWrapper = (key, setter) => value => {\n  localStorage.setItem(key, JSON.stringify(value));\n  setter(value);\n};\n\nconst traveler = (value, setter, historyValue, historySetter, futureValue, futureSetter) => ({\n  moveBack: () => {\n    futureSetter([value, ...futureValue]);\n    setter(historyValue.slice(-1)[0]);\n    historySetter(historyValue.slice(0, -1));\n  },\n  moveForward: () => {\n    historySetter([...historyValue, value]);\n    setter(futureValue[0]);\n    futureSetter(futureValue.slice(1));\n  },\n  viewTimeline: () => {\n    return {\n      past: historyValue,\n      present: value,\n      future: futureValue\n    };\n  },\n});\n\nconst historyHelpers = (key, value, setter, historyValue, historySetter, futureValue, futureSetter) => {\n  const historyEnabledSetter = (newValue) => {\n    setWrapper(`${key}History`, historySetter)([...historyValue, value]);\n    setWrapper(key, setter)(newValue);\n  };\n  const timeTraveler = traveler(value, setter, historyValue, historySetter, futureValue, futureSetter);\n  return [value, historyEnabledSetter, timeTraveler];\n\n};\nconst useStateWrapper = (key, defaultValue, enableHistory = false, transformStartingValue) => {\n  const startingValue = transformStartingValue\n    ? transformStartingValue(fetchFromLocalStorage(key, defaultValue))\n    : fetchFromLocalStorage(key, defaultValue);\n  const [value, setter] = useState(startingValue);\n  // outside the conditional because the order for React hooks is important\n  const startingHistoryValue = fetchFromLocalStorage(`${key}History`, []);\n  const [historyValue, historySetter] = useState(startingHistoryValue);\n  const startingFutureValue = fetchFromLocalStorage(`${key}Future`, []);\n  const [futureValue, futureSetter] = useState(startingFutureValue);\n  if (enableHistory) {\n    return historyHelpers(key, value, setter, historyValue, historySetter, futureValue, futureSetter);\n  } else {\n    return [value, setWrapper(key, setter)];\n  }\n};\n\nconst AppState = () => {\n  const [activeTab, setActiveTab] = useStateWrapper('activeTab', 'calculator');\n  const [history, setHistory] = useStateWrapper('history', []);\n  const [formula, setFormula] = useStateWrapper('formula', '');\n  const [result, setResult] = useStateWrapper('result', ['Not Rolled']);\n  const [rolls, setRolls] = useStateWrapper('rolls', []);\n  const [scrollToItem, setScrollToItem] = useState(null);\n  const pushHistoryItem = historyItem => setHistory([...history, historyItem]);\n\n  return {\n    activeTab, setActiveTab,\n    history, setHistory,\n    formula, setFormula,\n    result, setResult,\n    rolls, setRolls,\n    scrollToItem, setScrollToItem,\n    pushHistoryItem,\n  };\n};\n\nexport default AppState;\nexport { useStateWrapper };\n","const defaultCollectionsState = {\n  Root: {\n    collections: {\n      Shared: {\n        rolls: {\n          roll: 'r=1d20,(^adv&&^disadv)||(adv==0&&disadv==0)->r[0];(adv->r[0]>>r[1];r[0]<<r[1])',\n          atk: 'roll[0]==20->dmgDice[0]+dmgDice[1]+dmgMod;(roll[0]==1->0;roll[0]+bonus>ac@Defender->dmgDice[0]+dmgMod;0)',\n          bonus: 'prof+dmgMod',\n        },\n        collections: {\n          armor: {\n            collections: {},\n            rolls: {\n              shield: '2',\n              leatherArmor: '11+Dex',\n              paddedArmor: '11+Dex,badSneak=1',\n              studdedLeatherArmor: '12+Dex',\n              hideArmor: '12+(Dex<<2)',\n              chainShirt: '13+(Dex<<2)',\n              scaleMail: '14+(Dex<<2),badSneak=1',\n              breastPlate: '14+(Dex<<2),badSneak=1',\n              halfPlate: '15+(Dex<<2),badSneak=1',\n              ringMail: '14,badSneak=1',\n              chainMail: '16,badSneak=1,armorSpeedPenalty=Str<13->-10;0',\n              splintArmor: '17,badSneak=1,armorSpeedPenalty=Str<15->-10;0',\n              plateArmor: '18,badSneak=1,armorSpeedPenalty=Str<15->-10;0',\n            },\n          },\n          weapons: {\n            collections: {},\n            rolls: {\n              club: '1d4,dmgMod=Str',\n              dagger: '1d4,dmgMod=Dex>>Str,range=20,longRange=60',\n              greatClub: '1d8,dmgMod=Str',\n              handAxe: '1d6,dmgMod=Str,range=20,longRange=60',\n              javelin: '1d6,dmgMod=Str,range=30,longRange=120',\n              lightHammer: '1d4,dmgMod=Str,range=20,longRange=60',\n              mace: '1d6,dmgMod=Str',\n              quarterstaff: '^twoHanded->1d8;1d6,dmgMod=Str',\n              sickle: '1d4,dmgMod=Str',\n              spear: '1d6,dmgMod=Str,range=20,longRange=60',\n              unarmedStrike: '1,dmgMod=Str',\n              lightCrossbow: '1d8,dmgMod=Dex,range=80,longRange=320',\n              dart: '1d4,dmgMod=Dex>>Str,range=20,longRange=60',\n              shortbow: '1d6,dmgMod=Dex,range=80,longRange=320',\n              sling: '1d4,dmgMod=Dex,range=30,longRange=120',\n              battleaxe: '^twoHanded->1d10;1d8,dmgMod=Str',\n              flail: '1d8,dmgMod=Str',\n              glaive: '1d10,dmgMod=Str,reach=1',\n              greataxe: '1d12,dmgMod=Str',\n              greatsword: '2d6,dmgMod=Str',\n              halberd: '1d10,dmgMod=Str,reach=1',\n              lance: '1d12,dmgMod=Str,reach=1',\n              longSword: '^twoHanded->1d10;1d8,dmgMod=Str',\n              maul: '2d6,dmgMod=Str',\n              morningstar: '1d8,dmgMod=Str',\n              pike: '1d10,dmgMod=Str,reach=1',\n              rapier: '1d8,dmgMod=Dex>>Str',\n              scimitar: '1d6,dmgMod=Dex>>Str',\n              shortSword: '1d6,dmgMod=Dex>>Str',\n              trident: '^twoHanded->1d8;1d6,dmgMod=Str,range=20,longRange=60',\n              warPick: '1d8,dmgMod=Str',\n              warhammer: '^twoHanded->1d10;1d8,dmgMod=Str',\n              whip: '1d4,dmgMod=Dex>>Str,reach=1',\n              blowgun: '1,dmgMod=Dex,range=25,longRange=100',\n              handCrossbow: '1d6,dmgMod=Dex,range=30,longRange=120',\n              heavyCrossbow: '1d10,dmgMod=Dex,range=100,longRange=400',\n              longbow: '1d8,dmgMod=Dex,range=150,longRange=600',\n              net: '0,dmgMod=0,range=5,longRange=15',\n            },\n          },\n        },\n      },\n      Default: {\n        rolls: {},\n        collections: {},\n      },\n      'Example PC - Fighter': {\n        rolls: {\n          initiative: 'roll+Dex',\n          duelingStyle: '^ranged||^twoHanded->0;2',\n          'Attack with Long Sword': 'dmgDice=longSword,dmgMod=Str+duelingStyle,bonus=prof+Str,atk+atk',\n          secondWind: '1d10+5',\n          maneuverSaveDC: '8+prof+Str',\n          superiorityDie: '1d8',\n          Str: '4',\n          Dex: '2',\n          Con: '3',\n          Int: '0',\n          Wis: '1',\n          Cha: '-1',\n          prof: '3',\n          AC: 'chainMail+shield',\n        },\n        collections: {\n          saves: {\n            rolls: {\n              strSave: 'roll+Str+prof',\n              dexSave: 'roll+Dex',\n              conSave: 'roll+Con+prof',\n              intSave: 'roll+Int',\n              wisSave: 'roll+Wis',\n              chaSave: 'roll+Cha',\n            },\n            collections: {},\n          },\n          skills: {\n            rolls: {\n              Athletics: 'roll+Str+prof',\n              Acrobatics: 'roll+Dex',\n              'Sleight of Hand': 'roll+Dex',\n              Stealth: 'roll+Dex',\n              Arcana: 'roll+Int',\n              History: 'roll+Int',\n              Investigation: 'roll+Int',\n              Nature: 'roll+Int',\n              Religion: 'roll+Int',\n              'Animal Handling': 'roll+Wis',\n              Insight: 'roll+Wis',\n              Medicine: 'roll+Wis',\n              Perception: 'roll+Wis+prof',\n              Survival: 'roll+Wis',\n              Deception: 'roll+Cha',\n              Intimidation: 'roll+Cha',\n              Performance: 'roll+Cha',\n              Persuasion: 'roll+Cha',\n            },\n            collections: {},\n          },\n        },\n      },\n      'Example PC - Rogue': {\n        rolls: {\n          initiative: 'roll+Dex+Cha',\n          'Main Hand': 'dmgDice=shortSword+sneakAttackIfPossible,atk',\n          'Off Hand': 'dmgMod=0,dmgDice=shortSword+sneakAttackIfPossible,atk',\n          'Both Attacks': 'dmgDice=shortSword,(atk[0]+atk[1])>0->(atk[0]+atk[1]+sneakAttackIfPossible);0',\n          sneakAttackIfPossible: 'canYouSneakAttack->sneakAttack;0',\n          Str: '-1',\n          Dex: '4',\n          Con: '2',\n          Int: '0',\n          Wis: '1',\n          Cha: '3',\n          prof: '3',\n          AC: 'studdedLeatherArmor',\n          sneakAttack: '3d6',\n        },\n        collections: {\n          saves: {\n            rolls: {\n              strSave: 'roll+Str',\n              dexSave: 'roll+Dex+prof',\n              conSave: 'roll+Con',\n              intSave: 'roll+Int+prof',\n              wisSave: 'roll+Wis',\n              chaSave: 'roll+Cha',\n            },\n            collections: {},\n          },\n          skills: {\n            rolls: {\n              Athletics: 'roll+Str',\n              Acrobatics: 'roll+Dex+prof',\n              'Sleight of Hand': 'roll+Dex',\n              Stealth: 'roll+Dex+prof',\n              'Thieves\\' Tools': 'roll+Dex+2*prof',\n              Arcana: 'roll+Int',\n              History: 'roll+Int',\n              Investigation: 'roll+Int',\n              Nature: 'roll+Int',\n              Religion: 'roll+Int',\n              'Animal Handling': 'roll+Wis',\n              Insight: 'roll+Wis',\n              Medicine: 'roll+Wis',\n              Perception: 'roll+Wis+2*prof',\n              Survival: 'roll+Wis',\n              Deception: 'roll+Cha',\n              Intimidation: 'roll+Cha',\n              Performance: 'roll+Cha',\n              Persuasion: 'roll+Cha',\n            },\n            collections: {},\n          },\n        },\n      },\n    },\n    rolls: {},\n  },\n};\n\nexport default defaultCollectionsState;\n","export const getPathString = path => path.join('.collections.');\n\n","import immutably from 'immutably';\nimport {getPathString} from './helpers';\nimport {\n  getPropertyByPath,\n  getUniqueName, objectMakerReduceHelper,\n  removeFromObject,\n  renameObjectKey,\n  renameObjectKeyPreserveOrder,\n} from '../../lib/helpers';\n\nexport const organization = ({ activeCollection, collections, setActiveCollection, setCollections },\n    { convertPathStringToPathArray, currentCollection, getCollectionByPath, parentCollection, pathToParent }) => {\n\n  const createCollectionInCurrentCollection = ({name}) => setCollections(\n    immutably.set(\n      collections,\n      `${getPathString(activeCollection)}.collections.${name}`,\n      {\n        rolls: {},\n        collections: {},\n      }\n    ));\n  return {\n    createCollection: () => {\n      const name = getUniqueName('New Collection', currentCollection.collections);\n      createCollectionInCurrentCollection({name});\n      return name;\n    },\n\n    removeCurrentCollection: () => {\n      if (pathToParent === null) {\n        return;\n      }\n      const currentCollectionName = activeCollection.slice(-1)[0];\n      const {\n        [currentCollectionName]: _,\n        ...updatedCollections\n      } = parentCollection.collections;\n      setActiveCollection(activeCollection.slice(0, -1));\n      return setCollections(immutably.set(\n        collections,\n        `${getPathString(pathToParent)}.collections`,\n        updatedCollections\n      ));\n    },\n    duplicate: name => {\n      const newCollection = JSON.parse(JSON.stringify(\n        currentCollection.collections[name]\n      ));\n      return setCollections(immutably.set(\n        collections,\n        `${getPathString(activeCollection)}.collections`,\n        {...currentCollection.collections, [`Copy of ${name}`]: newCollection}\n      ));\n    },\n    move: (collectionName, destinationPath) => {\n      const currentPath = getPathString(activeCollection)\n        .replace(/(^Root)?.collections./g, '/')\n        .replace(/^Root/, '/');\n      if (destinationPath && destinationPath !== currentPath) {\n        const newPath = convertPathStringToPathArray(destinationPath);\n\n        const newCollection = getCollectionByPath(newPath);\n        if (typeof getPropertyByPath(newCollection, ['collections']) !== 'object') {\n          throw new Error('Bad path!');\n        } else if (newCollection.collections.hasOwnProperty(collectionName)) {\n          throw new Error(\n            'Cannot move this Collection. The destination Collection already has a child Collection by the same name.'\n          );\n        }\n        // add to new location\n        const updateStage1 = immutably.set(\n          collections,\n          `${getPathString(newPath)}.collections`,\n          {\n            ...newCollection.collections,\n            [collectionName]: currentCollection.collections[collectionName],\n          }\n        );\n        // we can't use currentCollection here in case the collection was moved to a child of it\n        const updatedCurrentCollection = getCollectionByPath(activeCollection, updateStage1);\n        // remove from old location\n        const updateStage2 = immutably.set(\n          updateStage1,\n          `${getPathString(activeCollection)}.collections`,\n          removeFromObject(collectionName, updatedCurrentCollection.collections)\n        );\n        setCollections(updateStage2);\n      }\n    },\n    moveChildCollection: (collectionName, newIndex) => {\n      const collArray = Object.entries(currentCollection.collections)\n        .filter(([name]) => name !== collectionName);\n      const newCollections = [\n        ...collArray.slice(0, newIndex),\n        [collectionName, currentCollection.collections[collectionName]],\n        ...collArray.slice(newIndex),\n      ].reduce(objectMakerReduceHelper, {});\n      return setCollections(immutably.set(\n        collections,\n        `${getPathString(activeCollection)}.collections`,\n        newCollections\n      ));\n    },\n    renameChildCollection: (oldName, newName, handleConflict) => {\n      if (currentCollection.collections.hasOwnProperty(newName)) {\n        if (typeof handleConflict === 'function') {\n          handleConflict();\n        }\n      } else {\n        const newCollections = renameObjectKeyPreserveOrder(oldName, newName, currentCollection.collections);\n        setCollections(immutably.set(\n          collections,\n          `${getPathString(activeCollection)}.collections`,\n          newCollections\n        ));\n      }\n    },\n    renameCurrentCollection: () => {\n      if (activeCollection.length <= 1) {\n        return;\n      }\n      const newName = window.prompt('Enter new name', '');\n      if (!newName) {\n        return;\n      } else if (parentCollection.collections.hasOwnProperty(newName)) {\n        alert(\n          'Cannot rename a Collection to be the same as another Collection under the same parent.');\n        return;\n      }\n      const updatedParentCollection = renameObjectKey(\n        activeCollection.slice(-1)[0],\n        newName,\n        parentCollection.collections\n      );\n      setCollections(immutably.set(\n        collections,\n        `${getPathString(pathToParent)}.collections`,\n        updatedParentCollection\n      ));\n      setActiveCollection([\n        ...pathToParent,\n        newName\n      ]);\n    },\n  };\n};\n","import immutably from 'immutably';\nimport { getPathString } from './helpers';\nimport {\n  getUniqueName,\n  objectMakerReduceHelper,\n  removeFromObject,\n  renameObjectKeyPreserveOrder,\n} from '../../lib/helpers';\nimport { formulaParser, formulaTokenizer } from 'roll-a-d6';\n\nconst { getTargetCollection,  stripPrefix, stripSuffix, variableTargetsCollection } = formulaTokenizer;\nconst { getMacrosFromCollection, getRollMetadata } = formulaParser;\n\nexport const rolls = ({ activeCollection, setActiveCollection, collections, setCollections },\n    { convertPathStringToPathArray, currentCollection, getCollectionByPath, getCurrentPath }) => {\n\n  const addRollToCurrentCollection = ({ formula, name }) => setCollections(\n    immutably.set(\n      collections,\n      `${getPathString(activeCollection)}.rolls.${name}`,\n      formula,\n    )\n  );\n\n  const getCollectionPathForSideEffect = (sideEffectName, targetCollections) =>\n    (variableTargetsCollection(sideEffectName))\n      ? convertPathStringToPathArray(targetCollections[getTargetCollection(sideEffectName)])\n      : activeCollection;\n\n  const applySideEffects = ({ currentCollections = collections, sideEffects = {}, targetCollections = {} }) => {\n    if (Object.entries(sideEffects).length === 0) {\n      // no need to update the collections history with an operation that changes nothing\n      return;\n    }\n    const newCollections = Object.entries(sideEffects).reduce((collectionsAccum, [name, value]) => {\n      const collectionPath = getCollectionPathForSideEffect(name, targetCollections);\n      const sideEffectBaseName = stripPrefix(stripSuffix(name));\n      return immutably.set(\n        collectionsAccum,\n        `${getPathString(collectionPath)}.rolls.${sideEffectBaseName}`,\n        `${value}`,\n      )\n    }, currentCollections);\n    setCollections(newCollections);\n  };\n  const clearHistoryReferenceFromRoll = roll =>\n    typeof roll === 'string'\n      ? roll\n      : removeFromObject('historyIndex', roll);\n\n  const clearCollectionHistoryReduceHelper = (accum, [collectionName, collection]) => ({\n    ...accum,\n    [collectionName]: {\n      ...collection,\n      rolls: Object.entries(collection.rolls).map(\n        ([rollName, roll]) => [rollName, clearHistoryReferenceFromRoll(roll)]\n      ).reduce(objectMakerReduceHelper, {}),\n      collections: Object.entries(collection.collections).reduce(clearCollectionHistoryReduceHelper, {})\n    },\n  });\n\n  const getRollFormula = roll => typeof roll === 'string' ? roll : roll.formula;\n\n  const getRolls = (rolls = currentCollection.rolls) => Object.entries(rolls).map(\n    ([name, roll]) => [name, getRollFormula(roll)]\n  ).reduce(objectMakerReduceHelper, {});\n\n  const getChildRolls = collection => Object.values(collection.collections)\n    .map(child => ({\n      ...getRolls(child.rolls),\n      ...getChildRolls(child),\n    }))\n    .reduce((accum, childRolls) => ({\n      ...accum,\n      ...childRolls,\n    }), {});\n\n\n  const parentRolls = [...Array(activeCollection.length - 1).keys()].reduce(\n    (accum, _, i) =>\n      ({\n        ...accum,\n        ...getRolls(getCollectionByPath(activeCollection.slice(0, i + 1)).rolls),\n      })\n    , {});\n  const sharedRolls = collections.Root.collections.hasOwnProperty('Shared')\n    ? {\n      ...getRolls(collections.Root.collections.Shared.rolls),\n      ...getChildRolls(collections.Root.collections.Shared),\n    }\n    : [];\n\n\n  const getRollDetails = (roll, macrosFromCollection) => {\n    const formula = getRollFormula(roll);\n    const rollDetails = getRollMetadata(formula, macrosFromCollection);\n    return { formula, ...rollDetails };\n  };\n\n  const getRollsWithDetails = (rolls = currentCollection.rolls) => {\n    const macrosFromCollection = getMacrosFromCollection({\n      ...sharedRolls,\n      ...parentRolls,\n      ...getRolls(),\n    });\n    return Object.entries(rolls).map(\n      ([name, roll]) => [name, getRollDetails(roll, macrosFromCollection)]\n    ).reduce(objectMakerReduceHelper, {});\n  };\n\n  return {\n    addRollToCurrentCollection,\n    // clear the historyIndex field out of all saved rolls\n    clearHistory: () => setCollections(Object.entries(collections).reduce(\n      clearCollectionHistoryReduceHelper,\n      {}\n    )),\n    cloneRoll: (name) => {\n      const newName = getUniqueName(name, currentCollection.rolls);\n      const newRolls = Object.entries(currentCollection.rolls).reduce(\n        (accum, [rollName, roll]) => (\n          rollName === name\n            ? {\n              ...accum,\n              [rollName]: roll,\n              [newName]: roll,\n            }\n            : {\n              ...accum,\n              [ rollName ]: roll,\n            }\n        ), {});\n      return setCollections(immutably.set(\n        collections,\n        `${getPathString(activeCollection)}.rolls`,\n        newRolls\n      ));\n    },\n    /**\n     * Create a new roll and add it to the current collection\n     * @returns {string} The name of the newly added roll\n     */\n    createRoll: () => {\n      const name = getUniqueName('New Roll', currentCollection.rolls)\n      const formula = '1d20';\n      addRollToCurrentCollection({ name, formula });\n      return name;\n    },\n    getRollFormula,\n    getRolls,\n    getRollsWithDetails,\n    moveToEnd: rollName => {\n      const newRolls = [\n        ...Object.entries(currentCollection.rolls)\n          .filter(([name]) => rollName !== name),\n        [rollName, currentCollection.rolls[rollName]],\n      ].reduce(objectMakerReduceHelper, {});\n      return setCollections(immutably.set(\n        collections,\n        `${getPathString(activeCollection)}.rolls`,\n        newRolls\n      ));\n    },\n    moveRoll: (rollName, newIndex) => {\n      const rollsArray = Object.entries(currentCollection.rolls)\n        .filter(([name]) => name !== rollName);\n      const newRolls = [\n        ...rollsArray.slice(0, newIndex),\n        [rollName, currentCollection.rolls[rollName]],\n        ...rollsArray.slice(newIndex),\n      ].reduce(objectMakerReduceHelper, {});\n      return setCollections(immutably.set(\n        collections,\n        `${getPathString(activeCollection)}.rolls`,\n        newRolls\n      ));\n    },\n    removeRoll: rollName => {\n      const { [rollName]: _, ...newRolls } = currentCollection.rolls;\n      return setCollections(immutably.set(\n        collections,\n        `${getPathString(activeCollection)}.rolls`,\n        newRolls\n      ));\n    },\n    renameRoll: (oldName, newName, handleConflict) => {\n      if (currentCollection.rolls.hasOwnProperty(newName)) {\n        if (typeof handleConflict === 'function') {\n          handleConflict();\n        }\n      } else {\n        const newRolls = renameObjectKeyPreserveOrder(oldName, newName, currentCollection.rolls);\n        setCollections(immutably.set(\n          collections,\n          `${getPathString(activeCollection)}.rolls`,\n          newRolls\n        ));\n      }\n    },\n    parentRolls,\n    saveRoll: formula => {\n      if (formula.length > 0) {\n        const name = window.prompt('Name of saved roll', '');\n        if (name && !currentCollection.rolls[name]) {\n          addRollToCurrentCollection({ formula, name });\n        } else if (name) {\n          const msg = 'Click OK to overwrite existing roll by that name';\n          if (window.confirm(msg)) {\n            addRollToCurrentCollection({ formula, name });\n          }\n        }\n      }\n    },\n    /**\n     *\n     * @param {object} p\n     * @param {number} p.historyIndex\n     * @param {string} p.name The name of the roll\n     * @param {ResultEntry[]} p.result An array containing the results of each expression\n     * @param {object.<number, string[]>} p.rolls An array containing the numbers rolled on any\n     *         dice in the expression\n     * @param {object} [p.sideEffects={}] Side effects as a result of the roll\n     * @param {object} [p.targetCollections] Selected Target collections for side effects with @target\n     */\n    setLastRoll: ({ historyIndex, name, result, rolls, sideEffects = {}, targetCollections }) => {\n      const rollObj = currentCollection.rolls[name];\n      const newRollObj = typeof rollObj === 'string'\n        ? {\n          formula: rollObj,\n          historyIndex,\n          result,\n          rolls,\n        }\n        : {\n          ...rollObj,\n          historyIndex,\n          result,\n          rolls,\n        };\n      const updatedCollections = immutably.set(\n        collections,\n        `${getPathString(activeCollection)}.rolls.${name}`,\n        newRollObj\n      );\n      if (Object.entries(sideEffects).length > 0) {\n        applySideEffects({ currentCollections: updatedCollections, sideEffects, targetCollections });\n      } else {\n        setCollections(updatedCollections);\n      }\n    },\n    sharedRolls,\n  };\n};\n","import { useStateWrapper } from '../AppState';\nimport defaultCollectionsState from './collectionsState.default';\nimport { navigation as Navigation } from './navigation';\nimport { organization as Organization } from './organization';\nimport { rolls as Rolls } from './rolls';\n\n/**\n * @typedef SavedRoll\n * @type {object|string}\n * @property {string} formula - The formula, e.g., '1d6'\n * @property {Array.<ResultEntry|ResultRange>} result - The last result rolled, e.g., 6\n * @property {object.<number,string[]>} rolls - Roll results - key is number of sides, value\n *           is an array of roll results (e.g., '4(d6)') in the order they were rolled\n * @property {number} historyIndex - The index in the history corresponding to the last result\n */\n\n/**\n * @typedef SavedCollection\n * @type {object}\n * @property {SavedCollections} collections - Child collections\n * @property {object.<string, SavedRoll>} rolls - Rolls and values in this collection\n */\n\n/**\n * @typedef SavedCollections\n * @type {object.<string, SavedCollection>}\n */\n\nconst CollectionsState = () => {\n  const [collections, setCollections] = useStateWrapper('collections', defaultCollectionsState);\n  const [activeCollection, setActiveCollection] = useStateWrapper('activeCollection', ['Root']);\n\n  const stateHooks = { collections, setCollections, activeCollection, setActiveCollection };\n\n  const navigation = Navigation(stateHooks);\n  const rolls = Rolls(stateHooks, navigation);\n  const organization = Organization(stateHooks, navigation);\n\n  return {\n    activeCollection,\n    collections,\n    ...navigation,\n    ...rolls,\n    ...organization,\n  };\n};\n\nexport default CollectionsState;\n","import {getPropertyByPath} from '../../lib/helpers';\n\nexport const navigation = ({ activeCollection, setActiveCollection, collections }) => {\n  const getCollectionByPathReduceHelper = (accum, pathSegment, i, path) => i < path.length - 1\n    ? [...accum, pathSegment, 'collections']\n    : [...accum, pathSegment];\n  /**\n   * @example\n   * getCollectionByPath(['Root', 'Example PC - Rogue', 'saves'])\n   *\n   * @param {string[]} path\n   * @param {SavedCollections} collectionsToSearch\n   * @returns {SavedCollection}\n   */\n  const getCollectionByPath = (path, collectionsToSearch = collections) =>\n    getPropertyByPath(collectionsToSearch,\n      path.reduce(getCollectionByPathReduceHelper, [])\n    );\n  const getCurrentPath = () => `${activeCollection.join('/')}`.replace(/^Root\\//, '/');\n  return {\n    /**\n     * @function\n     * @example // returns ['Root', 'Example PC - Rogue', 'saves']\n     * convertPathStringToPathArray('/Example PC - Rogue/saves')\n     * @param {string} path\n     * @returns {string[]}\n     */\n    convertPathStringToPathArray: path =>\n      (\n        path.substring(0,1) === '/'\n          ? path\n          : `${getCurrentPath()}/${path}`\n      ).replace(/^\\/?/, 'Root/')\n      .split('/')\n      .filter(_ => _),\n    getCollectionByPath,\n    getCollectionByPathReduceHelper,\n    getCurrentPath,\n    navigateToRoot: () => setActiveCollection(['Root']),\n    navigateToParent:\n      (parentNumber = 1) => setActiveCollection(activeCollection.slice(0, 0 - parentNumber)),\n    navigateTo: collection => setActiveCollection([\n      ...activeCollection,\n      collection\n    ]),\n    currentCollection: getCollectionByPath(activeCollection),\n    pathToParent: activeCollection.slice(0, -1),\n    parentCollection: activeCollection.length > 1\n      ? getCollectionByPath(activeCollection.slice(0, -1))\n      : null,\n  };\n};\n","import React, { useState } from 'react';\nimport \"./changelog.css\";\nimport { Animated } from 'react-animated-css';\nimport \"animate.css\";\n\nconst changes = [\n  {\n    version: '0.1',\n    date: '2019-Aug-5',\n    features: [\n      'Initial Release',\n      'Calculator, history, save rolls'\n    ]\n  },\n  {\n    version: '0.2',\n    date: '2019-Aug-6',\n    features: [\n      'Persist state to local storage',\n      'Style updates',\n      'Reduce scope of saved macro values to only be within the same macro'\n    ],\n  },\n  {\n    version: '0.3',\n    date: '2019-Aug-7',\n    features: [\n      'Initial support for && and || operators',\n      'Style updates',\n      'Create an editable textarea when clicking in the formula box',\n      'Allow it to not just look like a phone',\n      'Improved deployment procedure'\n    ],\n  },\n  {\n    version: '0.4',\n    date: '2019-Aug-8',\n    features: [\n      'Disable some instances of accidental zooming',\n      'Fix for | and & - characters were not passing validation',\n      'Fix prompt for unassigned variables'\n    ]\n  },\n  {\n    version: '0.5',\n    date: '2019-Aug-8',\n    features: [\n      'Disable some instances of accidental zooming',\n      'Fix for | and & - characters were not passing validation',\n      'Fix prompt for unassigned variables'\n    ]\n  },\n  {\n    version: '0.5.1',\n    date: '2019-Aug-9',\n    features: [\n      'Style updates',\n    ]\n  },\n  {\n    version: '0.6',\n    date: '2019-Aug-12',\n    features: [\n      'Behind the scenes improvements',\n      'Nested collections',\n      'Source formulas from active collection, shared collection, or parent collections of the active collection',\n      'Default collections on first load',\n      'Change macro buttons to pull from collections',\n      'When pressing dice buttons automatically prefix d# with 1 if there isn\\'t a number',\n      'Show roll info on macro buttons',\n      'Settings Tab that allows deleting all localStorage data for the app',\n    ],\n  },\n  {\n    version: '0.7',\n    date: '2019-Aug-13',\n    features: [\n      'Only pull in helper assignments from macros when we reference the macro by name in our expression or a dependency',\n      'Behind the scenes: JSDoc added for many complicated functions',\n      'Changelog added',\n    ],\n  },\n  {\n    version: '0.8',\n    date: '2019-Aug-15',\n    features: [\n      'Duplicate collections',\n      'Move collections - needs work',\n      'Rename collections',\n    ],\n  },\n  {\n    version: '0.9',\n    date: '2019-Aug-21',\n    features: [\n      'Global macro instance operator - {}',\n      '^ Operator - means \"assume this value is 0 if it\\'s not set\"',\n      'Roll saved rolls from the Collections page',\n    ],\n  },\n  {\n    version: '0.10',\n    date: '2019-Aug-23',\n    features: [\n      'Dice button images',\n      'Inline editing for saved rolls',\n      'Link from the Collections page to the associated History entry',\n      'Preserve location for the Collections, History, and Settings tab when navigating back and forth',\n    ],\n  },\n  {\n    version: '0.11',\n    date: '2019-Aug-24',\n    features: [\n      'Fix negative numbers',\n      'Styling fix',\n      'Division is now floored, to better support D&D - a non-flooring division operator may be added later',\n    ],\n  },\n  {\n    version: '0.11.1',\n    date: '2019-Aug-25',\n    features: [\n      'Fix negative numbers properly',\n      'Ensure that an expression\\'s helper macros by a given name are used before macros from a collection',\n    ],\n  },\n  {\n    version: '0.12',\n    date: '2019-Aug-25',\n    features: [\n      'Separate values and rolls',\n      'Supply values (including with formulas) to saved rolls in-line',\n    ],\n  },\n  {\n    version: '0.13',\n    date: '2019-Sep-8',\n    features: [\n      'Improved look & feel',\n      'Supply collections when collection formulas use macro@target notation',\n      'Expansion operators (#+, #*, #&, #|)',\n      'Support for a single unknown variable (using a value of ?)',\n      'Inline inputs for the values needed by collection saved rolls, with defaults',\n      'Go to history from collection roll and highlight the history entry',\n    ],\n  },\n  {\n    version: '0.14',\n    date: '2019-Sep-9',\n    features: [\n      'Tooltips on calculator buttons',\n      'Buttons for max and min',\n      'Style fixes and color changes',\n      'Layout improvements',\n    ],\n  },\n  {\n    version: '0.15',\n    date: '2019-Sep-18',\n    features: [\n      'Show helper info in history items',\n      'Fix bug that crashed the whole app permanently if an invalid formula was entered',\n      'Add tests for default collection state',\n      'Add extra info if an error is encountered when rolling (both saved and calculator)',\n      'List 5E PHB armor and weapons in default collection',\n      'Nested collections inside Shared (all get loaded)',\n      'Support renaming saved rolls, values, and collections',\n      'Support cloning saved rolls',\n      'Drag and drop to reorder saved rolls, values, and collections',\n      'Buttons to collapse/expand all saved rolls or all saved values',\n    ],\n  },\n  {\n    version: '0.16',\n    date: '2020-Feb-18',\n    features: [\n      'Move core rolling library into its own repository',\n      'Only dice that were actually rolled as part of the formula are listed now',\n    ],\n  },\n  {\n    version: '0.17',\n    date: '2020-Mar-2',\n    features: [\n      'Side effect support: $varname',\n      'Side effect operator: +=',\n      'Side effect operator: -=',\n      'Side effect operator: := to assign the value',\n      'Side effects: support recursing with internal side effects',\n      'Side effects: support modifying current collection',\n      'Side effects: support modifying target collection',\n      'Targeted variables now dynamically update as the target value updates',\n    ],\n  },\n  {\n    version: '0.18',\n    date: '2020-Mar-3',\n    features: [\n      'Rudimentary import / export'\n    ],\n  },\n];\n\nconst Changelog = () => {\n  const [changelogVisible, setChangelogVisible] = useState(false);\n  const toggleVisible = () => setChangelogVisible(!changelogVisible);\n  return (<div className=\"changelog\">\n    <h2 className=\"collapseHeader\" onClick={toggleVisible}>\n      {\n        changelogVisible\n          ? ' Changelog (Click to Hide)'\n          : ' Changelog (Click to Show)'\n      }\n    </h2>\n    <Animated\n      animateOnMount={false}\n      animationIn=\"slideInUp\"\n      animationOut=\"slideOutDown\"\n      animationDuration=\"500\"\n      isVisible={changelogVisible}\n    >\n      <ul className=\"change-list\">\n        {/* eslint-disable-next-line fp/no-mutating-methods */\n          [...changes].reverse().map(({version, date, features}, i) => (<li\n            key={i}\n            className=\"change\"\n          >\n            <div className=\"info\">Version <strong>{version}</strong><br />{date}</div>\n            <ul className=\"features-list\">{ features.map(\n              (feature, i) => (\n                <li key={i} className=\"feature\">{feature}</li>)\n            )}</ul>\n          </li>))}\n      </ul>\n    </Animated>\n  </div>);\n};\n\nexport default Changelog;\n","import React from 'react';\nimport './settings.css';\nimport Changelog from './Changelog';\nimport { saveAs } from 'file-saver';\n\nconst styles = {\n  bold: { fontWeight: 'bold' },\n};\n\nconst handleFile = async (file) => {\n  console.log(file);\n  if (!file) {\n    return;\n  }\n  const confirm = window.confirm('Are you sure? You will lose all your data.');\n  if (confirm) {\n    const data = await file.text();\n    if (data) {\n      localStorage.setItem('collections', data);\n      window.location.reload();\n    }\n  }\n};\n\nconst Settings = () => (<div className=\"settings\">\n  <h1>Settings</h1>\n  <div className=\"settings-body\">\n    <div className=\"settings-section\">\n      <h2>Export Data</h2>\n      <p>NOTE: Currently, we only support full overwrites.</p>\n      <button className=\"export\" onClick={() => {\n        const file = new File([localStorage.collections], 'DiceExport.json', { type: 'application/json;charset=utf-8' });\n        saveAs(file);\n      }}>Export</button>\n      <h2>Import Data</h2>\n      <p style={styles.bold}>Please export your data prior to importing data.</p>\n      <label>Import: <input\n        type=\"file\"\n        accept=\"application/json\"\n        onChange={event => handleFile(event.currentTarget.files[0])}\n      />\n      </label>\n    </div>\n    <div className=\"settings-section\">\n      <h2>Clear Local Data</h2>\n      <p>Are you having issues with the app, or do you just want to restore the default settings?\n        Try clearing your local data and then refreshing the page.\n      </p>\n      <p style={styles.bold}>\n        NOTE: This is irreversible and you will lose all saved rolls and history.\n      </p>\n      <button className=\"clear-localstorage\" onClick={() => {\n        const confirm = window.confirm('Are you sure? You will lose all your data.');\n        if (confirm) {\n          localStorage.clear();\n        }\n      }}>Clear Localstorage</button>\n    </div>\n    <div className=\"settings-section\">\n      <Changelog />\n    </div>\n  </div>\n</div>);\n\nexport default Settings;\n","import React from 'react';\nimport './App.css';\nimport Calculator from './components/Calculator';\nimport History from './components/History';\nimport Collections from './components/Collections';\nimport AppState from './state/AppState';\nimport CollectionsState from './state/CollectionsState';\nimport { rollFormula } from 'roll-a-d6';\nimport Settings from \"./components/Settings\";\n\nconst App = () => {\n\n  const {\n    activeTab, setActiveTab,\n    formula, setFormula,\n    result, setResult,\n    rolls, setRolls,\n    scrollToItem, setScrollToItem,\n    history, setHistory, pushHistoryItem,\n  } = AppState();\n  const collectionState = CollectionsState();\n\n\n  const clearHistory = () => {\n    setHistory([]);\n    collectionState.clearHistory();\n  };\n\n  const defaultRollSuccessCallback = ({ result, resultRange, rolls }) => {\n    setResult(resultRange || result);\n    setRolls(rolls);\n  };\n  const roll = (expression = formula, successCallback = defaultRollSuccessCallback) => {\n    try {\n      const helpersMap = {\n        ...collectionState.sharedRolls,\n        ...collectionState.parentRolls,\n        ...collectionState.getRolls(),\n      };\n      const rollResult = rollFormula(expression, helpersMap);\n      successCallback({ expression, ...rollResult });\n\n      const helpers = [\n        ...Object.entries(collectionState.sharedRolls).map(([name, helper]) => ({ name, source: 'Shared', value: helper })),\n        ...Object.entries(collectionState.parentRolls).map(([name, helper]) => ({ name, source: 'Parent', value: helper })),\n        ...Object.entries(collectionState.getRolls()).map(([name, helper]) => ({ name, source: `/${collectionState.activeCollection.join('/')}`, value: helper })),\n      ].filter(({ name }, i, ary) => !ary.slice(i + 1).some(helper => helper.name === name))\n        .filter(({ name }) => (rollResult.allMacros || {}).hasOwnProperty(name))\n        .filter(({ name }) => !rollResult.macros.hasOwnProperty(name));\n\n      pushHistoryItem({ formula: expression, ...rollResult, helpers });\n    } catch (err) {\n      console.error(err);\n      setResult(['Error!']);\n      setRolls([]);\n    }\n  };\n\n  const calculatorMacros = {\n    ...collectionState.getRolls(collectionState.sharedRolls),\n    ...(Object.keys(collectionState.currentCollection.rolls).length > 0\n      ? collectionState.getRolls()\n      : collectionState.parentRolls)\n  };\n\n  return (<div className=\"App\">\n    {activeTab === 'calculator'\n      ? <Calculator\n        formula={formula}\n        result={result}\n        rolls={rolls}\n        macros={calculatorMacros}\n        setFormula={setFormula}\n        saveRoll={() => collectionState.saveRoll(formula)}\n        roll={() => roll()} // use default params since it's called from an event handler\n      />\n      : null}\n    <div style={activeTab !== 'collections' ? { display: 'none' } : {}}>\n      <Collections\n        collectionState={collectionState}\n        history={history}\n        roll={roll}\n        saveRoll={collectionState.addRollToCurrentCollection}\n        selectCalculator={() => setActiveTab('calculator')}\n        selectHistory={(item) => {\n          setScrollToItem(item);\n          setActiveTab('history');\n        }}\n        setFormula={setFormula}\n      />\n    </div>\n    <div style={activeTab !== 'history' ? { display: 'none' } : {}}>\n      <History\n        clearHistory={clearHistory}\n        history={history}\n        scrollTo={scrollToItem}\n        setScrollTo={setScrollToItem}\n      />\n    </div>\n    <div style={activeTab !== 'settings' ? { display: 'none' } : {}}>\n      <Settings />\n    </div>\n    <div className=\"app-nav\">\n      <button\n        onClick={() => setActiveTab('collections')}\n        className={activeTab === 'collections' ? 'active' : ''}\n      >\n        Collections\n      </button>\n      <button\n        onClick={() => setActiveTab('calculator')}\n        className={activeTab === 'calculator' ? 'active' : ''}\n      >\n        Calculator\n      </button>\n      <button\n        onClick={() => setActiveTab('history')}\n        className={activeTab === 'history' ? 'active' : ''}\n      >\n        History\n      </button>\n      <button\n        onClick={() => setActiveTab('settings')}\n        className={activeTab === 'settings' ? 'active' : ''}\n      >\n        Settings\n      </button>\n    </div>\n  </div>);\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}